<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formación Bíblica Avanzada - Plataforma Integral</title>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Chart.js para visualizaciones -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    
    <!-- Marked.js para renderizado Markdown -->
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
    
    <!-- Font Awesome para iconos -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Configuración de Tailwind -->
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        discord: {
                            primary: '#5865F2',
                            secondary: '#2F3136',
                            tertiary: '#202225',
                            input: '#40444B',
                            hover: '#4752C4',
                            success: '#57F287',
                            warning: '#FEE75C',
                            error: '#ED4245',
                            light: '#F2F3F5',
                            lightSecondary: '#E3E5E8',
                            lightTertiary: '#EBEDEF'
                        }
                    },
                    animation: {
                        'fade-in': 'fadeIn 0.3s ease-in-out',
                        'slide-in': 'slideIn 0.3s ease-out',
                        'slide-up': 'slideUp 0.3s ease-out',
                        'pulse-soft': 'pulseSoft 2s ease-in-out infinite',
                        'typing': 'typing 3.5s steps(40, end)',
                        'blink': 'blink 1s infinite'
                    },
                    fontFamily: {
                        'whitney': ['Whitney', 'Helvetica Neue', 'Helvetica', 'Arial', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <!-- Estilos personalizados -->
    <style>
        :root {
            --bg-primary: #5865F2;
            --bg-secondary: #2F3136;
            --bg-tertiary: #202225;
            --bg-input: #40444B;
            --text-primary: #FFFFFF;
            --text-secondary: #DCDDDE;
            --text-muted: #72767D;
            --interactive-normal: #B9BBBE;
            --interactive-hover: #DCDDDE;
            --interactive-active: #FFFFFF;
            --success: #57F287;
            --warning: #FEE75C;
            --error: #ED4245;
            --scrollbar-thin-thumb: rgba(79, 84, 92, 0.3);
            --scrollbar-thin-track: transparent;
            --scrollbar-auto-thumb: #202225;
            --scrollbar-auto-track: #2E3338;
        }
        
        .light {
            --bg-primary: #5865F2;
            --bg-secondary: #F2F3F5;
            --bg-tertiary: #FFFFFF;
            --bg-input: #EBEDEF;
            --text-primary: #2E3338;
            --text-secondary: #4F5660;
            --text-muted: #6A7480;
            --interactive-normal: #4F5660;
            --interactive-hover: #2E3338;
            --interactive-active: #2E3338;
            --scrollbar-auto-thumb: #E3E5E8;
            --scrollbar-auto-track: #F2F3F5;
        }
        
        body {
            font-family: 'Whitney', 'Helvetica Neue', Helvetica, Arial, sans-serif;
            background-color: var(--bg-tertiary);
            color: var(--text-primary);
            line-height: 1.5;
            transition: all 0.3s ease;
        }
        
        .discord-card {
            background-color: var(--bg-secondary);
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        
        .discord-card:hover {
            background-color: var(--bg-input);
        }
        
        .discord-text-secondary {
            color: var(--text-secondary);
        }
        
        .discord-text-muted {
            color: var(--text-muted);
        }
        
        .discord-input {
            background-color: var(--bg-input);
            color: var(--text-primary);
            border: none;
            outline: none;
            transition: all 0.2s ease;
        }
        
        .discord-input:focus {
            outline: 2px solid var(--bg-primary);
            box-shadow: 0 0 0 2px rgba(88, 101, 242, 0.2);
        }
        
        .discord-button-primary {
            background-color: var(--bg-primary);
            color: var(--text-primary);
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }
        
        .discord-button-primary:hover {
            background-color: #4752c4;
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(88, 101, 242, 0.3);
        }
        
        .discord-button-secondary {
            background-color: var(--bg-input);
            color: var(--text-primary);
            transition: all 0.2s;
            border: none;
            cursor: pointer;
        }
        
        .discord-button-secondary:hover {
            background-color: #36393f;
            transform: translateY(-1px);
        }
        
        .discord-button-secondary.active {
            background-color: var(--bg-primary);
            color: white;
        }
        
        .discord-button-danger {
            background-color: var(--error);
            color: white;
            transition: all 0.2s;
        }
        
        .discord-button-danger:hover {
            background-color: #c53030;
        }
        
        .discord-button-success {
            background-color: var(--success);
            color: var(--bg-tertiary);
            transition: all 0.2s;
        }
        
        .discord-button-success:hover {
            background-color: #38a169;
        }
        
        /* Scrollbar personalizado */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-thumb {
            background-color: var(--scrollbar-thin-thumb);
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-track {
            background-color: var(--scrollbar-thin-track);
        }
        
        /* Animaciones personalizadas */
        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        
        @keyframes slideIn {
            from { transform: translateX(-100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        
        @keyframes slideUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        @keyframes pulseSoft {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        @keyframes typing {
            from { width: 0; }
            to { width: 100%; }
        }
        
        @keyframes blink {
            from, to { border-color: transparent; }
            50% { border-color: var(--bg-primary); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-in-out;
        }
        
        .animate-slideIn {
            animation: slideIn 0.3s ease-out;
        }
        
        .animate-slideUp {
            animation: slideUp 0.3s ease-out;
        }
        
        /* Estilos específicos para filtros */
        .filtro-card {
            border: 1px solid var(--bg-input);
            border-radius: 6px;
            overflow: hidden;
            transition: all 0.3s ease;
        }
        
        .filtro-card:hover {
            border-color: var(--bg-primary);
            box-shadow: 0 0 0 1px rgba(88, 101, 242, 0.2);
        }
        
        .filtro-header {
            background-color: var(--bg-input);
            transition: all 0.2s ease;
        }
        
        .filtro-header:hover {
            background-color: rgba(88, 101, 242, 0.1);
        }
        
        /* Estilos para la Biblia */
        .biblia-versiculo-numero {
            display: inline-block;
            min-width: 1.5rem;
            margin-right: 0.5rem;
            color: var(--bg-primary);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s ease;
        }
        
        .biblia-versiculo-numero:hover {
            color: #4752c4;
            transform: scale(1.1);
        }
        
        .biblia-versiculo {
            padding: 0.25rem;
            border-radius: 4px;
            margin: 0.25rem 0;
            transition: all 0.2s ease;
            cursor: pointer;
        }
        
        .biblia-versiculo:hover {
            background-color: rgba(88, 101, 242, 0.05);
        }
        
        .biblia-versiculo.seleccionado {
            background-color: rgba(88, 101, 242, 0.1);
            border-left: 3px solid var(--bg-primary);
            padding-left: 0.75rem;
        }
        
        .biblia-versiculo.destacado {
            background-color: rgba(254, 231, 92, 0.2);
            border-left: 3px solid var(--warning);
        }
        
        .biblia-versiculo.favorito {
            background-color: rgba(87, 242, 135, 0.1);
            border-left: 3px solid var(--success);
        }
        
        /* Estilos para el modo de estudio */
        .modo-estudio-container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 1rem;
            min-height: 600px;
        }
        
        @media (max-width: 768px) {
            .modo-estudio-container {
                grid-template-columns: 1fr;
            }
        }
        
        /* Loader mejorado */
        .loader {
            border-radius: 50%;
            border: 2px solid transparent;
            border-top: 2px solid var(--bg-primary);
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        /* Estilos para chat */
        .mensaje-chat {
            padding: 0.5rem;
            margin: 0.25rem 0;
            border-radius: 8px;
            background-color: var(--bg-input);
            transition: all 0.2s ease;
        }
        
        .mensaje-chat:hover {
            background-color: rgba(88, 101, 242, 0.1);
        }
        
        .mensaje-chat.propio {
            background-color: rgba(88, 101, 242, 0.2);
            margin-left: 2rem;
        }
        
        /* Estilos para notificaciones mejoradas */
        .notificacion {
            transform: translateX(100%);
            transition: transform 0.3s ease;
        }
        
        .notificacion.mostrar {
            transform: translateX(0);
        }
        
        /* Estilos para tabs */
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
            animation: fadeIn 0.3s ease;
        }
        
        /* Estilos para tooltip */
        .tooltip {
            position: relative;
        }
        
        .tooltip::after {
            content: attr(data-tooltip);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background-color: var(--bg-secondary);
            color: var(--text-primary);
            padding: 0.5rem;
            border-radius: 4px;
            font-size: 0.75rem;
            white-space: nowrap;
            opacity: 0;
            pointer-events: none;
            transition: opacity 0.2s;
            z-index: 1000;
        }
        
        .tooltip:hover::after {
            opacity: 1;
        }
        
        /* Estilos para split panel */
        .split-panel {
            display: flex;
            height: 100%;
        }
        
        .split-left {
            flex: 1;
            overflow-y: auto;
        }
        
        .split-right {
            width: 300px;
            border-left: 1px solid var(--bg-input);
            overflow-y: auto;
        }
        
        .split-resizer {
            width: 4px;
            background-color: var(--bg-input);
            cursor: col-resize;
            transition: background-color 0.2s;
        }
        
        .split-resizer:hover {
            background-color: var(--bg-primary);
        }
        
        /* Estilos para progress bar */
        .progress-bar {
            background-color: var(--bg-input);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .progress-fill {
            height: 8px;
            background-color: var(--bg-primary);
            transition: width 0.3s ease;
            border-radius: 4px;
        }
        
        /* Estilos para accordion */
        .accordion-item {
            border: 1px solid var(--bg-input);
            border-radius: 6px;
            margin-bottom: 0.5rem;
            overflow: hidden;
        }
        
        .accordion-header {
            background-color: var(--bg-input);
            padding: 1rem;
            cursor: pointer;
            transition: all 0.2s ease;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .accordion-header:hover {
            background-color: rgba(88, 101, 242, 0.1);
        }
        
        .accordion-content {
            max-height: 0;
            overflow: hidden;
            transition: max-height 0.3s ease;
        }
        
        .accordion-content.open {
            max-height: 1000px;
        }
        
        /* Estilos para badges */
        .badge {
            display: inline-block;
            padding: 0.25rem 0.5rem;
            border-radius: 12px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .badge-primary {
            background-color: var(--bg-primary);
            color: white;
        }
        
        .badge-success {
            background-color: var(--success);
            color: var(--bg-tertiary);
        }
        
        .badge-warning {
            background-color: var(--warning);
            color: var(--bg-tertiary);
        }
        
        .badge-error {
            background-color: var(--error);
            color: white;
        }
        
        /* Estilos para grid de libros bíblicos */
        .libros-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
            gap: 0.5rem;
        }
        
        .libro-card {
            background-color: var(--bg-input);
            padding: 0.75rem;
            border-radius: 6px;
            text-align: center;
            cursor: pointer;
            transition: all 0.2s ease;
            border: 2px solid transparent;
        }
        
        .libro-card:hover {
            background-color: rgba(88, 101, 242, 0.1);
            border-color: var(--bg-primary);
            transform: translateY(-2px);
        }
        
        .libro-card.seleccionado {
            background-color: rgba(88, 101, 242, 0.2);
            border-color: var(--bg-primary);
        }
        
        /* Responsive adjustments */
        @media (max-width: 640px) {
            .split-panel {
                flex-direction: column;
            }
            
            .split-right {
                width: 100%;
                border-left: none;
                border-top: 1px solid var(--bg-input);
                max-height: 300px;
            }
            
            .libros-grid {
                grid-template-columns: repeat(auto-fill, minmax(100px, 1fr));
            }
            
            .modo-estudio-container {
                grid-template-columns: 1fr;
                gap: 0.5rem;
            }
        }
        
        /* Estilos para markdown */
        .markdown-content h1,
        .markdown-content h2,
        .markdown-content h3,
        .markdown-content h4,
        .markdown-content h5,
        .markdown-content h6 {
            color: var(--text-primary);
            margin-top: 1rem;
            margin-bottom: 0.5rem;
        }
        
        .markdown-content p {
            margin-bottom: 1rem;
        }
        
        .markdown-content ul,
        .markdown-content ol {
            margin-left: 1.5rem;
            margin-bottom: 1rem;
        }
        
        .markdown-content code {
            background-color: var(--bg-input);
            padding: 0.125rem 0.25rem;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
        
        .markdown-content blockquote {
            border-left: 4px solid var(--bg-primary);
            padding-left: 1rem;
            margin: 1rem 0;
            font-style: italic;
            color: var(--text-secondary);
        }
        
        /* Dark/Light mode transitions */
        * {
            transition: background-color 0.3s ease, color 0.3s ease, border-color 0.3s ease;
        }
        
        /* Accessibility improvements */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        
        /* Focus visible improvements */
        .discord-button-primary:focus-visible,
        .discord-button-secondary:focus-visible,
        .discord-input:focus-visible {
            outline: 2px solid var(--bg-primary);
            outline-offset: 2px;
        }
        
        /* High contrast mode support */
        @media (prefers-contrast: high) {
            .discord-card {
                border: 1px solid var(--text-secondary);
            }
            
            .discord-button-primary,
            .discord-button-secondary {
                border: 1px solid var(--text-primary);
            }
        }
        
        /* Reduced motion support */
        @media (prefers-reduced-motion: reduce) {
            *,
            *::before,
            *::after {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }
    </style>
</head>
<body class="min-h-screen">
    <!-- Loading screen -->
    <div id="loading-screen" class="fixed inset-0 bg-discord-tertiary z-50 flex items-center justify-center">
        <div class="text-center">
            <div class="loader w-12 h-12 mx-auto mb-4"></div>
            <h2 class="text-2xl font-bold mb-2">Formación Bíblica Avanzada</h2>
            <p class="discord-text-secondary">Cargando plataforma integral...</p>
            <div class="mt-4 w-64 progress-bar">
                <div id="loading-progress" class="progress-fill w-0"></div>
            </div>
        </div>
    </div>

    <div id="main-app" class="container mx-auto px-4 py-6 hidden">
        <!-- Encabezado mejorado -->
        <header class="mb-6">
            <div class="flex flex-col lg:flex-row justify-between items-center">
                <div class="flex items-center mb-4 lg:mb-0">
                    <div class="w-12 h-12 bg-discord-primary rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-book-open text-white text-xl"></i>
                    </div>
                    <div>
                        <h1 class="text-2xl lg:text-3xl font-bold">Formación Bíblica Avanzada</h1>
                        <p class="discord-text-secondary text-sm">Plataforma Integral de Estudio v2.0</p>
                    </div>
                </div>
                
                <!-- Barra de búsqueda global -->
                <div class="flex items-center space-x-2 mb-4 lg:mb-0">
                    <div class="relative">
                        <input type="text" id="busqueda-global" class="discord-input text-base rounded-lg px-4 py-2 pl-10 w-64" placeholder="Buscar en toda la Biblia...">
                        <i class="fas fa-search absolute left-3 top-3 discord-text-muted"></i>
                        <div id="busqueda-sugerencias" class="absolute top-full left-0 w-full bg-discord-secondary rounded-lg mt-1 shadow-lg z-30 hidden max-h-64 overflow-y-auto"></div>
                    </div>
                </div>
                
                <!-- Controles de usuario -->
                <div class="flex items-center space-x-2">
                    <!-- Modo lectura -->
                    <button id="modo-lectura-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm tooltip" data-tooltip="Modo de lectura">
                        <i class="fas fa-glasses"></i>
                        <span class="ml-1 hidden sm:inline">Lectura</span>
                    </button>
                    
                    <!-- Tema -->
                    <button id="theme-toggle-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm tooltip" data-tooltip="Cambiar tema">
                        <i class="fas fa-moon" id="theme-icon"></i>
                        <span class="ml-1 hidden sm:inline">Tema</span>
                    </button>
                    
                    <!-- Notificaciones -->
                    <button id="notifications-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm tooltip relative" data-tooltip="Notificaciones">
                        <i class="fas fa-bell"></i>
                        <span id="notifications-badge" class="absolute -top-1 -right-1 bg-discord-error text-white text-xs rounded-full w-5 h-5 flex items-center justify-center hidden">3</span>
                        <span class="ml-1 hidden sm:inline">Alertas</span>
                    </button>
                    
                    <!-- Usuario -->
                    <button id="user-menu-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm tooltip" data-tooltip="Perfil de usuario">
                        <i class="fas fa-user-circle"></i>
                        <span class="ml-1 hidden sm:inline">Perfil</span>
                    </button>
                    
                    <!-- Configuración -->
                    <button id="settings-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm tooltip" data-tooltip="Configuración">
                        <i class="fas fa-cog"></i>
                        <span class="ml-1 hidden sm:inline">Config</span>
                    </button>
                </div>
            </div>
            
            <!-- Barra de progreso de sesión -->
            <div class="mt-4">
                <div class="flex justify-between items-center mb-2">
                    <span class="text-sm discord-text-secondary">Progreso de estudio de hoy</span>
                    <span class="text-sm discord-text-secondary" id="tiempo-sesion">0:00</span>
                </div>
                <div class="progress-bar">
                    <div id="progreso-sesion" class="progress-fill w-0"></div>
                </div>
            </div>
        </header>
        
        <!-- Navegación principal mejorada -->
        <nav class="discord-card p-2 rounded-lg mb-6 sticky top-4 z-20">
            <div class="flex flex-wrap justify-center lg:justify-start space-x-1 lg:space-x-2">
                <!-- Navegación principal -->
                <button id="nav-biblia-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm active flex items-center">
                    <i class="fas fa-book-open mr-2"></i>
                    <span>Biblia</span>
                </button>
                
                <button id="nav-estudio-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm flex items-center">
                    <i class="fas fa-lightbulb mr-2"></i>
                    <span>Estudio</span>
                </button>
                
                <button id="nav-filtros-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm flex items-center">
                    <i class="fas fa-filter mr-2"></i>
                    <span>Filtros</span>
                </button>
                
                <button id="nav-social-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm flex items-center">
                    <i class="fas fa-users mr-2"></i>
                    <span>Social</span>
                </button>
                
                <button id="nav-recursos-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm flex items-center">
                    <i class="fas fa-tools mr-2"></i>
                    <span>Recursos</span>
                </button>
                
                <button id="nav-ai-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm flex items-center">
                    <i class="fas fa-robot mr-2"></i>
                    <span>IA</span>
                </button>
                
                <button id="nav-estadisticas-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm flex items-center">
                    <i class="fas fa-chart-line mr-2"></i>
                    <span>Stats</span>
                </button>
                
                <div class="flex-grow"></div>
                
                <!-- Navegación secundaria (se muestra según contexto) -->
                <div id="nav-secundaria" class="flex space-x-1">
                    <!-- Botones de navegación social -->
                    <button id="social-general-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm hidden">
                        <i class="fas fa-comments mr-1"></i>General
                    </button>
                    
                    <button id="social-teoria-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm hidden">
                        <i class="fas fa-graduation-cap mr-1"></i>Teoría
                    </button>
                    
                    <button id="social-practica-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm hidden">
                        <i class="fas fa-dumbbell mr-1"></i>Práctica
                    </button>
                    
                    <!-- Botones de filtros -->
                    <button id="filtro-sangre-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm hidden">
                        <i class="fas fa-tint mr-1"></i>Sangre
                    </button>
                    
                    <button id="filtro-agua-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm hidden">
                        <i class="fas fa-water mr-1"></i>Agua
                    </button>
                    
                    <!-- Botones de estudio -->
                    <button id="estudio-comparar-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm hidden">
                        <i class="fas fa-code-branch mr-1"></i>Comparar
                    </button>
                    
                    <button id="estudio-notas-btn" class="discord-button-secondary px-3 py-2 rounded-lg text-sm hidden">
                        <i class="fas fa-sticky-note mr-1"></i>Notas
                    </button>
                </div>
            </div>
        </nav>
        
        <!-- Contenido principal -->
        <main class="min-h-screen">
            <!-- Contenedor de Biblia (Mejorado masivamente) -->
            <div id="content-biblia" class="animate-fadeIn">
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-4">
                    <!-- Panel de navegación bíblica -->
                    <div class="lg:col-span-1">
                        <div class="discord-card p-4 rounded-lg sticky top-24">
                            <h3 class="font-semibold mb-3 flex items-center">
                                <i class="fas fa-bookmark mr-2"></i>
                                Navegación
                            </h3>
                            
                            <!-- Selección de versión -->
                            <div class="mb-4">
                                <label class="text-sm discord-text-secondary">Versión</label>
                                <select id="version-biblia" class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                    <option value="rvr1960">Reina Valera 1960</option>
                                    <option value="rvr1995">Reina Valera 1995</option>
                                    <option value="nvi">Nueva Versión Internacional</option>
                                    <option value="dhh">Dios Habla Hoy</option>
                                    <option value="nblh">Nueva Biblia Latinoamericana</option>
                                </select>
                            </div>
                            
                            <!-- Testamentos -->
                            <div class="mb-4">
                                <div class="flex space-x-2 mb-2">
                                    <button id="btn-antiguo-testamento" class="flex-1 discord-button-secondary px-2 py-1 rounded text-sm active">
                                        AT
                                    </button>
                                    <button id="btn-nuevo-testamento" class="flex-1 discord-button-secondary px-2 py-1 rounded text-sm">
                                        NT
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Lista de libros -->
                            <div class="mb-4">
                                <label class="text-sm discord-text-secondary">Libro</label>
                                <div id="libros-container" class="mt-2 max-h-48 overflow-y-auto">
                                    <div class="libros-grid">
                                        <!-- Los libros se cargarán dinámicamente -->
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Selección de capítulo -->
                            <div class="mb-4">
                                <label class="text-sm discord-text-secondary">Capítulo</label>
                                <select id="capitulo-select" class="w-full discord-input text-sm rounded px-2 py-1 mt-1" disabled>
                                    <option value="">Seleccionar capítulo...</option>
                                </select>
                            </div>
                            
                            <!-- Navegación rápida -->
                            <div class="mb-4">
                                <label class="text-sm discord-text-secondary">Ir a referencia</label>
                                <div class="flex mt-1">
                                    <input type="text" id="referencia-rapida" class="flex-grow discord-input text-sm rounded-l px-2 py-1" placeholder="ej: Juan 3:16">
                                    <button id="ir-referencia-btn" class="discord-button-primary text-sm rounded-r px-3 py-1">
                                        <i class="fas fa-arrow-right"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Favoritos y marcadores -->
                            <div class="mb-4">
                                <h4 class="text-sm font-medium mb-2">Accesos rápidos</h4>
                                <div class="space-y-1">
                                    <button class="w-full text-left discord-button-secondary px-2 py-1 rounded text-sm">
                                        <i class="fas fa-heart text-red-500 mr-2"></i>Juan 3:16
                                    </button>
                                    <button class="w-full text-left discord-button-secondary px-2 py-1 rounded text-sm">
                                        <i class="fas fa-heart text-red-500 mr-2"></i>Salmos 23
                                    </button>
                                    <button class="w-full text-left discord-button-secondary px-2 py-1 rounded text-sm">
                                        <i class="fas fa-bookmark text-yellow-500 mr-2"></i>1 Corintios 13
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Panel principal de lectura -->
                    <div class="lg:col-span-2">
                        <div class="discord-card p-6 rounded-lg">
                            <!-- Cabecera del capítulo -->
                            <div class="flex justify-between items-center mb-6">
                                <div>
                                    <h2 id="capitulo-titulo" class="text-2xl font-bold">Génesis 1</h2>
                                    <p id="capitulo-subtitulo" class="discord-text-secondary">La Creación</p>
                                </div>
                                
                                <div class="flex items-center space-x-2">
                                    <!-- Controles de texto -->
                                    <button id="disminuir-texto-btn" class="discord-button-secondary p-2 rounded tooltip" data-tooltip="Disminuir texto">
                                        <i class="fas fa-minus"></i>
                                    </button>
                                    <span id="tamano-texto-actual" class="text-sm px-2">100%</span>
                                    <button id="aumentar-texto-btn" class="discord-button-secondary p-2 rounded tooltip" data-tooltip="Aumentar texto">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                    
                                    <!-- Modo audio -->
                                    <button id="audio-play-btn" class="discord-button-secondary p-2 rounded tooltip" data-tooltip="Reproducir audio">
                                        <i class="fas fa-play"></i>
                                    </button>
                                    
                                    <!-- Compartir -->
                                    <button id="compartir-capitulo-btn" class="discord-button-secondary p-2 rounded tooltip" data-tooltip="Compartir">
                                        <i class="fas fa-share-alt"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Navegación de capítulos -->
                            <div class="flex justify-between items-center mb-4">
                                <button id="capitulo-anterior-btn" class="discord-button-secondary px-4 py-2 rounded flex items-center" disabled>
                                    <i class="fas fa-chevron-left mr-2"></i>Anterior
                                </button>
                                
                                <div class="flex items-center space-x-2">
                                    <span class="text-sm discord-text-secondary">Capítulo</span>
                                    <input type="number" id="capitulo-input" class="discord-input text-center w-16 rounded px-2 py-1" value="1" min="1">
                                    <span class="text-sm discord-text-secondary">de <span id="total-capitulos">50</span></span>
                                </div>
                                
                                <button id="capitulo-siguiente-btn" class="discord-button-secondary px-4 py-2 rounded flex items-center">
                                    Siguiente<i class="fas fa-chevron-right ml-2"></i>
                                </button>
                            </div>
                            
                            <!-- Contenido bíblico -->
                            <div id="contenido-biblico" class="space-y-2 text-base leading-relaxed">
                                <div class="biblia-versiculo">
                                    <span class="biblia-versiculo-numero">1</span>
                                    En el principio creó Dios los cielos y la tierra.
                                    <div class="inline-flex ml-2 space-x-1 opacity-0 group-hover:opacity-100 transition-opacity">
                                        <button class="text-xs p-1 tooltip" data-tooltip="Agregar a favoritos">
                                            <i class="fas fa-heart"></i>
                                        </button>
                                        <button class="text-xs p-1 tooltip" data-tooltip="Destacar">
                                            <i class="fas fa-highlighter"></i>
                                        </button>
                                        <button class="text-xs p-1 tooltip" data-tooltip="Agregar nota">
                                            <i class="fas fa-sticky-note"></i>
                                        </button>
                                        <button class="text-xs p-1 tooltip" data-tooltip="Compartir">
                                            <i class="fas fa-share"></i>
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="biblia-versiculo">
                                    <span class="biblia-versiculo-numero">2</span>
                                    Y la tierra estaba desordenada y vacía, y las tinieblas estaban sobre la faz del abismo, y el Espíritu de Dios se movía sobre la faz de las aguas.
                                </div>
                                
                                <div class="biblia-versiculo">
                                    <span class="biblia-versiculo-numero">3</span>
                                    Y dijo Dios: Sea la luz; y fue la luz.
                                </div>
                                
                                <!-- Más versículos se cargarán dinámicamente -->
                            </div>
                            
                            <!-- Notas del capítulo -->
                            <div class="mt-8 pt-6 border-t border-discord-input">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-sticky-note mr-2"></i>
                                    Notas de estudio
                                </h4>
                                <div id="notas-capitulo" class="space-y-2 text-sm discord-text-secondary">
                                    <p><strong>v.1:</strong> "En el principio" - Hebreo: בְּרֵאשִׁית (bereshit). Indica el comienzo absoluto.</p>
                                    <p><strong>v.2:</strong> "Espíritu de Dios" - Hebreo: רוּחַ אֱלֹהִים (ruach elohim). Primera mención del Espíritu.</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Panel lateral de herramientas -->
                    <div class="lg:col-span-1">
                        <div class="space-y-4">
                            <!-- Herramientas de versículo -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-tools mr-2"></i>
                                    Herramientas
                                </h4>
                                
                                <div class="space-y-2">
                                    <button id="activar-comparacion-btn" class="w-full discord-button-secondary px-3 py-2 rounded text-sm">
                                        <i class="fas fa-code-branch mr-2"></i>Comparar versiones
                                    </button>
                                    
                                    <button id="activar-comentarios-btn" class="w-full discord-button-secondary px-3 py-2 rounded text-sm">
                                        <i class="fas fa-comments mr-2"></i>Ver comentarios
                                    </button>
                                    
                                    <button id="activar-referencias-btn" class="w-full discord-button-secondary px-3 py-2 rounded text-sm">
                                        <i class="fas fa-link mr-2"></i>Referencias cruzadas
                                    </button>
                                    
                                    <button id="activar-original-btn" class="w-full discord-button-secondary px-3 py-2 rounded text-sm">
                                        <i class="fas fa-language mr-2"></i>Texto original
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Plan de lectura -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-calendar-check mr-2"></i>
                                    Plan de lectura
                                </h4>
                                
                                <div class="space-y-3">
                                    <div class="flex justify-between items-center">
                                        <span class="text-sm">Progreso diario</span>
                                        <span class="text-sm discord-text-secondary">2/5 capítulos</span>
                                    </div>
                                    <div class="progress-bar">
                                        <div class="progress-fill w-2/5"></div>
                                    </div>
                                    
                                    <div class="text-sm discord-text-secondary">
                                        <p><strong>Siguiente:</strong> Génesis 2</p>
                                        <p><strong>Meta semanal:</strong> 15 capítulos</p>
                                    </div>
                                    
                                    <button class="w-full discord-button-primary px-3 py-2 rounded text-sm">
                                        <i class="fas fa-play mr-2"></i>Continuar plan
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Estadísticas rápidas -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-chart-bar mr-2"></i>
                                    Estadísticas
                                </h4>
                                
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Tiempo de lectura:</span>
                                        <span class="discord-text-secondary">~3 min</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Versículos:</span>
                                        <span class="discord-text-secondary">31</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Palabras:</span>
                                        <span class="discord-text-secondary">783</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Tema principal:</span>
                                        <span class="discord-text-secondary">Creación</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Notas personales -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-pencil-alt mr-2"></i>
                                    Notas personales
                                </h4>
                                
                                <textarea id="notas-personales" class="w-full h-24 discord-input text-sm rounded px-2 py-1 resize-none" placeholder="Escribe tus reflexiones..."></textarea>
                                
                                <div class="flex justify-between mt-2">
                                    <button class="discord-button-secondary px-3 py-1 rounded text-sm">
                                        <i class="fas fa-microphone mr-1"></i>Voz
                                    </button>
                                    <button id="guardar-nota-btn" class="discord-button-primary px-3 py-1 rounded text-sm">
                                        <i class="fas fa-save mr-1"></i>Guardar
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Contenedor de Estudio (Masivamente mejorado) -->
            <div id="content-estudio" class="animate-fadeIn hidden">
                <div class="grid grid-cols-1 xl:grid-cols-3 gap-6">
                    <!-- Panel principal de estudio -->
                    <div class="xl:col-span-2">
                        <div class="discord-card p-6 rounded-lg">
                            <!-- Tabs de estudio -->
                            <div class="flex flex-wrap border-b border-discord-input mb-6">
                                <button class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent hover:border-discord-primary" data-tab="analisis">
                                    <i class="fas fa-search mr-2"></i>Análisis
                                </button>
                                <button class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent hover:border-discord-primary active" data-tab="comparacion">
                                    <i class="fas fa-code-branch mr-2"></i>Comparación
                                </button>
                                <button class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent hover:border-discord-primary" data-tab="comentarios">
                                    <i class="fas fa-comments mr-2"></i>Comentarios
                                </button>
                                <button class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent hover:border-discord-primary" data-tab="concordancia">
                                    <i class="fas fa-list mr-2"></i>Concordancia
                                </button>
                                <button class="tab-btn px-4 py-2 text-sm font-medium border-b-2 border-transparent hover:border-discord-primary" data-tab="original">
                                    <i class="fas fa-language mr-2"></i>Original
                                </button>
                            </div>
                            
                            <!-- Contenido de análisis -->
                            <div id="tab-analisis" class="tab-content">
                                <h3 class="text-xl font-semibold mb-4">Análisis Textual Avanzado</h3>
                                
                                <!-- Selector de pasaje -->
                                <div class="mb-6 p-4 bg-discord-input/30 rounded-lg">
                                    <h4 class="font-medium mb-3">Seleccionar pasaje para análisis</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                        <div>
                                            <label class="text-sm discord-text-secondary">Libro</label>
                                            <select id="analisis-libro" class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                                <option value="genesis">Génesis</option>
                                                <option value="exodo">Éxodo</option>
                                                <option value="juan">Juan</option>
                                                <option value="romanos">Romanos</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="text-sm discord-text-secondary">Capítulo</label>
                                            <input type="number" id="analisis-capitulo" class="w-full discord-input text-sm rounded px-2 py-1 mt-1" value="1" min="1">
                                        </div>
                                        <div>
                                            <label class="text-sm discord-text-secondary">Versículos</label>
                                            <input type="text" id="analisis-versiculos" class="w-full discord-input text-sm rounded px-2 py-1 mt-1" placeholder="1-5" value="1-3">
                                        </div>
                                    </div>
                                    <button id="cargar-analisis-btn" class="mt-4 discord-button-primary px-4 py-2 rounded">
                                        <i class="fas fa-search mr-2"></i>Analizar pasaje
                                    </button>
                                </div>
                                
                                <!-- Resultados del análisis -->
                                <div id="resultados-analisis" class="space-y-6">
                                    <!-- Análisis estructural -->
                                    <div class="discord-card p-4 rounded-lg">
                                        <h5 class="font-medium mb-3 flex items-center">
                                            <i class="fas fa-sitemap mr-2"></i>Estructura del texto
                                        </h5>
                                        <div id="estructura-texto" class="space-y-2 text-sm">
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <p><strong>Género literario:</strong> Narrativa histórica</p>
                                                <p><strong>Estructura:</strong> Introducción - Desarrollo - Conclusión</p>
                                                <p><strong>Figuras retóricas:</strong> Paralelismo, quiasmo</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Análisis léxico -->
                                    <div class="discord-card p-4 rounded-lg">
                                        <h5 class="font-medium mb-3 flex items-center">
                                            <i class="fas fa-book mr-2"></i>Análisis léxico
                                        </h5>
                                        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                            <div>
                                                <h6 class="text-sm font-medium mb-2">Palabras clave</h6>
                                                <div class="space-y-1 text-sm">
                                                    <div class="flex justify-between p-2 bg-discord-input/20 rounded">
                                                        <span>Dios (אֱלֹהִים)</span>
                                                        <span class="badge badge-primary">3x</span>
                                                    </div>
                                                    <div class="flex justify-between p-2 bg-discord-input/20 rounded">
                                                        <span>Crear (בָּרָא)</span>
                                                        <span class="badge badge-primary">1x</span>
                                                    </div>
                                                    <div class="flex justify-between p-2 bg-discord-input/20 rounded">
                                                        <span>Tierra (אֶרֶץ)</span>
                                                        <span class="badge badge-primary">2x</span>
                                                    </div>
                                                </div>
                                            </div>
                                            <div>
                                                <h6 class="text-sm font-medium mb-2">Campos semánticos</h6>
                                                <div class="space-y-1 text-sm">
                                                    <div class="p-2 bg-discord-input/20 rounded">
                                                        <strong>Creación:</strong> crear, formar, hacer
                                                    </div>
                                                    <div class="p-2 bg-discord-input/20 rounded">
                                                        <strong>Cosmos:</strong> cielos, tierra, aguas
                                                    </div>
                                                    <div class="p-2 bg-discord-input/20 rounded">
                                                        <strong>Luz/oscuridad:</strong> luz, tinieblas
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Análisis temático -->
                                    <div class="discord-card p-4 rounded-lg">
                                        <h5 class="font-medium mb-3 flex items-center">
                                            <i class="fas fa-tags mr-2"></i>Análisis temático
                                        </h5>
                                        <div class="space-y-3">
                                            <div>
                                                <h6 class="text-sm font-medium mb-2">Temas principales</h6>
                                                <div class="flex flex-wrap gap-2">
                                                    <span class="badge badge-primary">Soberanía de Dios</span>
                                                    <span class="badge badge-primary">Orden del caos</span>
                                                    <span class="badge badge-primary">Palabra creadora</span>
                                                    <span class="badge badge-primary">Bondad de la creación</span>
                                                </div>
                                            </div>
                                            <div>
                                                <h6 class="text-sm font-medium mb-2">Conexiones teológicas</h6>
                                                <div class="space-y-2 text-sm">
                                                    <p>• Relacionado con Juan 1:1-3 (Logos creador)</p>
                                                    <p>• Paralelo con Colosenses 1:16 (Cristo creador)</p>
                                                    <p>• Eco en Hebreos 11:3 (fe en la creación)</p>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Contenido de comparación -->
                            <div id="tab-comparacion" class="tab-content active">
                                <h3 class="text-xl font-semibold mb-4">Comparación de Versiones</h3>
                                
                                <!-- Selector de versiones -->
                                <div class="mb-6 p-4 bg-discord-input/30 rounded-lg">
                                    <h4 class="font-medium mb-3">Configurar comparación</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="text-sm discord-text-secondary">Versión principal</label>
                                            <select id="version-principal" class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                                <option value="rvr1960">Reina Valera 1960</option>
                                                <option value="rvr1995">Reina Valera 1995</option>
                                                <option value="nvi">Nueva Versión Internacional</option>
                                                <option value="dhh">Dios Habla Hoy</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="text-sm discord-text-secondary">Versión de comparación</label>
                                            <select id="version-comparacion" class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                                <option value="nvi">Nueva Versión Internacional</option>
                                                <option value="rvr1960">Reina Valera 1960</option>
                                                <option value="rvr1995">Reina Valera 1995</option>
                                                <option value="dhh">Dios Habla Hoy</option>
                                                <option value="lbla">La Biblia de las Américas</option>
                                            </select>
                                        </div>
                                    </div>
                                    <div class="mt-4">
                                        <label class="text-sm discord-text-secondary">Pasaje a comparar</label>
                                        <input type="text" id="pasaje-comparacion" class="w-full discord-input text-sm rounded px-2 py-1 mt-1" placeholder="ej: Juan 3:16" value="Génesis 1:1-3">
                                    </div>
                                    <button id="comparar-versiones-btn" class="mt-4 discord-button-primary px-4 py-2 rounded">
                                        <i class="fas fa-code-branch mr-2"></i>Comparar
                                    </button>
                                </div>
                                
                                <!-- Resultados de comparación -->
                                <div id="comparacion-resultados" class="space-y-4">
                                    <!-- Comparación lado a lado -->
                                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-4">
                                        <div class="discord-card p-4 rounded-lg">
                                            <h5 class="font-medium mb-3 text-discord-primary">Reina Valera 1960</h5>
                                            <div class="space-y-2 text-sm leading-relaxed">
                                                <p><span class="font-bold text-discord-primary">1</span> En el principio creó Dios los cielos y la tierra.</p>
                                                <p><span class="font-bold text-discord-primary">2</span> Y la tierra estaba desordenada y vacía, y las tinieblas estaban sobre la faz del abismo, y el Espíritu de Dios se movía sobre la faz de las aguas.</p>
                                                <p><span class="font-bold text-discord-primary">3</span> Y dijo Dios: Sea la luz; y fue la luz.</p>
                                            </div>
                                        </div>
                                        
                                        <div class="discord-card p-4 rounded-lg">
                                            <h5 class="font-medium mb-3 text-discord-success">Nueva Versión Internacional</h5>
                                            <div class="space-y-2 text-sm leading-relaxed">
                                                <p><span class="font-bold text-discord-success">1</span> Dios, en el principio, creó los cielos y la tierra.</p>
                                                <p><span class="font-bold text-discord-success">2</span> La tierra era un caos total, las tinieblas cubrían el abismo, y el Espíritu de Dios iba y venía sobre la superficie de las aguas.</p>
                                                <p><span class="font-bold text-discord-success">3</span> Y dijo Dios: «¡Que exista la luz!» Y la luz llegó a existir.</p>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <!-- Análisis de diferencias -->
                                    <div class="discord-card p-4 rounded-lg">
                                        <h5 class="font-medium mb-3 flex items-center">
                                            <i class="fas fa-search mr-2"></i>Análisis de diferencias
                                        </h5>
                                        <div class="space-y-3 text-sm">
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <h6 class="font-medium mb-2">Versículo 1 - Orden de palabras</h6>
                                                <p><strong>RVR1960:</strong> "En el principio creó Dios..."</p>
                                                <p><strong>NVI:</strong> "Dios, en el principio, creó..."</p>
                                                <p class="mt-2 discord-text-secondary">La NVI enfatiza el sujeto (Dios) al colocarlo al inicio.</p>
                                            </div>
                                            
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <h6 class="font-medium mb-2">Versículo 2 - Descripción del estado inicial</h6>
                                                <p><strong>RVR1960:</strong> "desordenada y vacía"</p>
                                                <p><strong>NVI:</strong> "un caos total"</p>
                                                <p class="mt-2 discord-text-secondary">La NVI usa una expresión más contemporánea para transmitir el concepto de תֹהוּ וָבֹהוּ (tohu wa-bohu).</p>
                                            </div>
                                            
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <h6 class="font-medium mb-2">Versículo 3 - Discurso directo</h6>
                                                <p><strong>RVR1960:</strong> "Sea la luz"</p>
                                                <p><strong>NVI:</strong> "¡Que exista la luz!"</p>
                                                <p class="mt-2 discord-text-secondary">La NVI usa exclamación para enfatizar el poder de la palabra divina.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Contenido de comentarios -->
                            <div id="tab-comentarios" class="tab-content">
                                <h3 class="text-xl font-semibold mb-4">Comentarios Bíblicos</h3>
                                
                                <!-- Selector de comentario -->
                                <div class="mb-6 p-4 bg-discord-input/30 rounded-lg">
                                    <h4 class="font-medium mb-3">Seleccionar comentario</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="text-sm discord-text-secondary">Comentarista</label>
                                            <select id="comentarista-select" class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                                <option value="henry">Matthew Henry</option>
                                                <option value="clarke">Adam Clarke</option>
                                                <option value="barnes">Albert Barnes</option>
                                                <option value="expositors">Expositor's Bible</option>
                                                <option value="jamieson">Jamieson-Fausset-Brown</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="text-sm discord-text-secondary">Pasaje</label>
                                            <input type="text" id="pasaje-comentario" class="w-full discord-input text-sm rounded px-2 py-1 mt-1" placeholder="ej: Génesis 1:1" value="Génesis 1:1-3">
                                        </div>
                                    </div>
                                    <button id="cargar-comentario-btn" class="mt-4 discord-button-primary px-4 py-2 rounded">
                                        <i class="fas fa-comments mr-2"></i>Cargar comentario
                                    </button>
                                </div>
                                
                                <!-- Comentarios -->
                                <div id="comentarios-contenido" class="space-y-4">
                                    <div class="discord-card p-6 rounded-lg">
                                        <div class="flex items-center mb-4">
                                            <div class="w-10 h-10 bg-discord-primary rounded-full flex items-center justify-center mr-3">
                                                <i class="fas fa-user text-white"></i>
                                            </div>
                                            <div>
                                                <h5 class="font-medium">Matthew Henry</h5>
                                                <p class="text-sm discord-text-secondary">Comentario sobre Génesis 1:1-3</p>
                                            </div>
                                        </div>
                                        
                                        <div class="prose prose-sm max-w-none">
                                            <p class="mb-4">En el principio creó Dios los cielos y la tierra. Observe aquí:</p>
                                            
                                            <ol class="list-decimal list-inside space-y-2 mb-4">
                                                <li><strong>Que el mundo tuvo un principio.</strong> No es eterno. La materia no es eterna; tuvo un principio. Y en este principio del tiempo fue cuando Dios creó los cielos y la tierra.</li>
                                                
                                                <li><strong>Que Dios fue antes de este principio.</strong> De este modo se establece la eternidad de Dios, y se refuta la doctrina atea de la eternidad del mundo.</li>
                                                
                                                <li><strong>Que Dios es el Creador de todas las cosas.</strong> La palabra traducida "creó" (bara) se usa especialmente para la acción divina que produce algo de la nada.</li>
                                            </ol>
                                            
                                            <p class="mb-4">La tierra estaba desordenada y vacía. Estas palabras describen el estado del mundo material antes de que Dios comenzara la obra de ordenarlo y poblarlo. Era "tohu wa-bohu", un abismo de confusión.</p>
                                            
                                            <p>Y dijo Dios: Sea la luz. Aquí comienza la obra de la creación propiamente dicha. Todo se hace por la palabra de Dios; Él habla y es hecho. Esta palabra de poder se menciona en cada día de la creación.</p>
                                        </div>
                                        
                                        <div class="mt-6 pt-4 border-t border-discord-input">
                                            <div class="flex items-center justify-between">
                                                <div class="flex space-x-4">
                                                    <button class="text-sm discord-text-secondary hover:text-discord-primary">
                                                        <i class="fas fa-heart mr-1"></i>Me gusta
                                                    </button>
                                                    <button class="text-sm discord-text-secondary hover:text-discord-primary">
                                                        <i class="fas fa-share mr-1"></i>Compartir
                                                    </button>
                                                    <button class="text-sm discord-text-secondary hover:text-discord-primary">
                                                        <i class="fas fa-bookmark mr-1"></i>Guardar
                                                    </button>
                                                </div>
                                                <div class="text-sm discord-text-secondary">
                                                    Siglo XVIII
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Contenido de concordancia -->
                            <div id="tab-concordancia" class="tab-content">
                                <h3 class="text-xl font-semibold mb-4">Concordancia Temática</h3>
                                
                                <!-- Búsqueda en concordancia -->
                                <div class="mb-6 p-4 bg-discord-input/30 rounded-lg">
                                    <h4 class="font-medium mb-3">Buscar en concordancia</h4>
                                    <div class="flex space-x-4">
                                        <div class="flex-grow">
                                            <input type="text" id="buscar-concordancia" class="w-full discord-input text-base rounded px-3 py-2" placeholder="Buscar palabra o tema...">
                                        </div>
                                        <button id="buscar-concordancia-btn" class="discord-button-primary px-4 py-2 rounded">
                                            <i class="fas fa-search mr-2"></i>Buscar
                                        </button>
                                    </div>
                                    
                                    <div class="mt-4 flex flex-wrap gap-2">
                                        <span class="text-sm discord-text-secondary">Búsquedas populares:</span>
                                        <button class="badge badge-primary cursor-pointer hover:bg-discord-hover">amor</button>
                                        <button class="badge badge-primary cursor-pointer hover:bg-discord-hover">fe</button>
                                        <button class="badge badge-primary cursor-pointer hover:bg-discord-hover">salvación</button>
                                        <button class="badge badge-primary cursor-pointer hover:bg-discord-hover">oración</button>
                                        <button class="badge badge-primary cursor-pointer hover:bg-discord-hover">perdón</button>
                                    </div>
                                </div>
                                
                                <!-- Resultados de concordancia -->
                                <div id="concordancia-resultados" class="space-y-4">
                                    <div class="discord-card p-4 rounded-lg">
                                        <h5 class="font-medium mb-3 flex items-center">
                                            <i class="fas fa-list mr-2"></i>
                                            Resultados para "crear" (78 ocurrencias)
                                        </h5>
                                        
                                        <div class="space-y-3">
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <div class="flex justify-between items-start mb-2">
                                                    <h6 class="font-medium text-discord-primary">Génesis 1:1</h6>
                                                    <span class="badge badge-primary">AT</span>
                                                </div>
                                                <p class="text-sm">En el principio <mark class="bg-discord-primary/30 px-1 rounded">creó</mark> Dios los cielos y la tierra.</p>
                                            </div>
                                            
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <div class="flex justify-between items-start mb-2">
                                                    <h6 class="font-medium text-discord-primary">Génesis 1:21</h6>
                                                    <span class="badge badge-primary">AT</span>
                                                </div>
                                                <p class="text-sm">Y <mark class="bg-discord-primary/30 px-1 rounded">creó</mark> Dios los grandes monstruos marinos, y todo ser viviente que se mueve...</p>
                                            </div>
                                            
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <div class="flex justify-between items-start mb-2">
                                                    <h6 class="font-medium text-discord-primary">Génesis 1:27</h6>
                                                    <span class="badge badge-primary">AT</span>
                                                </div>
                                                <p class="text-sm">Y <mark class="bg-discord-primary/30 px-1 rounded">creó</mark> Dios al hombre a su imagen, a imagen de Dios lo <mark class="bg-discord-primary/30 px-1 rounded">creó</mark>...</p>
                                            </div>
                                            
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <div class="flex justify-between items-start mb-2">
                                                    <h6 class="font-medium text-discord-primary">Colosenses 1:16</h6>
                                                    <span class="badge badge-success">NT</span>
                                                </div>
                                                <p class="text-sm">Porque en él fueron <mark class="bg-discord-primary/30 px-1 rounded">creadas</mark> todas las cosas, las que hay en los cielos y las que hay en la tierra...</p>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-4 flex justify-center">
                                            <button class="discord-button-secondary px-4 py-2 rounded">
                                                Ver más resultados
                                            </button>
                                        </div>
                                    </div>
                                    
                                    <!-- Análisis estadístico -->
                                    <div class="discord-card p-4 rounded-lg">
                                        <h5 class="font-medium mb-3 flex items-center">
                                            <i class="fas fa-chart-bar mr-2"></i>
                                            Análisis estadístico
                                        </h5>
                                        
                                        <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                                            <div class="text-center p-3 bg-discord-input/20 rounded">
                                                <div class="text-2xl font-bold text-discord-primary">78</div>
                                                <div class="text-sm discord-text-secondary">Total de ocurrencias</div>
                                            </div>
                                            <div class="text-center p-3 bg-discord-input/20 rounded">
                                                <div class="text-2xl font-bold text-discord-primary">32</div>
                                                <div class="text-sm discord-text-secondary">Libros diferentes</div>
                                            </div>
                                            <div class="text-center p-3 bg-discord-input/20 rounded">
                                                <div class="text-2xl font-bold text-discord-primary">68%</div>
                                                <div class="text-sm discord-text-secondary">En Antiguo Testamento</div>
                                            </div>
                                        </div>
                                        
                                        <div class="mt-4">
                                            <h6 class="text-sm font-medium mb-2">Distribución por libros</h6>
                                            <div class="space-y-2">
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm">Génesis</span>
                                                    <div class="flex items-center space-x-2">
                                                        <div class="w-20 h-2 bg-discord-input rounded-full overflow-hidden">
                                                            <div class="h-full bg-discord-primary w-4/5"></div>
                                                        </div>
                                                        <span class="text-sm discord-text-secondary">12</span>
                                                    </div>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm">Colosenses</span>
                                                    <div class="flex items-center space-x-2">
                                                        <div class="w-20 h-2 bg-discord-input rounded-full overflow-hidden">
                                                            <div class="h-full bg-discord-primary w-2/5"></div>
                                                        </div>
                                                        <span class="text-sm discord-text-secondary">6</span>
                                                    </div>
                                                </div>
                                                <div class="flex justify-between items-center">
                                                    <span class="text-sm">Salmos</span>
                                                    <div class="flex items-center space-x-2">
                                                        <div class="w-20 h-2 bg-discord-input rounded-full overflow-hidden">
                                                            <div class="h-full bg-discord-primary w-1/5"></div>
                                                        </div>
                                                        <span class="text-sm discord-text-secondary">4</span>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Contenido de texto original -->
                            <div id="tab-original" class="tab-content">
                                <h3 class="text-xl font-semibold mb-4">Texto Original</h3>
                                
                                <!-- Selector de pasaje -->
                                <div class="mb-6 p-4 bg-discord-input/30 rounded-lg">
                                    <h4 class="font-medium mb-3">Analizar texto original</h4>
                                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                                        <div>
                                            <label class="text-sm discord-text-secondary">Idioma original</label>
                                            <select id="idioma-original" class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                                <option value="hebreo">Hebreo (Antiguo Testamento)</option>
                                                <option value="griego">Griego (Nuevo Testamento)</option>
                                                <option value="arameo">Arameo (Porciones)</option>
                                            </select>
                                        </div>
                                        <div>
                                            <label class="text-sm discord-text-secondary">Pasaje</label>
                                            <input type="text" id="pasaje-original" class="w-full discord-input text-sm rounded px-2 py-1 mt-1" placeholder="ej: Génesis 1:1" value="Génesis 1:1">
                                        </div>
                                    </div>
                                    <button id="analizar-original-btn" class="mt-4 discord-button-primary px-4 py-2 rounded">
                                        <i class="fas fa-language mr-2"></i>Analizar
                                    </button>
                                </div>
                                
                                <!-- Análisis del texto original -->
                                <div id="original-resultados" class="space-y-6">
                                    <!-- Texto hebreo/griego -->
                                    <div class="discord-card p-6 rounded-lg">
                                        <h5 class="font-medium mb-4 flex items-center">
                                            <i class="fas fa-language mr-2"></i>
                                            Texto Hebreo Masorético
                                        </h5>
                                        
                                        <div class="text-right text-2xl font-hebrew mb-4 p-4 bg-discord-input/20 rounded leading-relaxed">
                                            בְּרֵאשִׁית בָּרָא אֱלֹהִים אֵת הַשָּׁמַיִם וְאֵת הָאָרֶץ
                                        </div>
                                        
                                        <div class="text-sm discord-text-secondary">
                                            <p><strong>Transliteración:</strong> B'reshit bara Elohim et hashamayim v'et ha'aretz</p>
                                            <p><strong>Traducción literal:</strong> En-principio creó Dios ACC los-cielos y-ACC la-tierra</p>
                                        </div>
                                    </div>
                                    
                                    <!-- Análisis morfológico -->
                                    <div class="discord-card p-4 rounded-lg">
                                        <h5 class="font-medium mb-3 flex items-center">
                                            <i class="fas fa-microscope mr-2"></i>
                                            Análisis morfológico
                                        </h5>
                                        
                                        <div class="overflow-x-auto">
                                            <table class="w-full text-sm">
                                                <thead>
                                                    <tr class="bg-discord-input/50">
                                                        <th class="p-3 text-left">Palabra</th>
                                                        <th class="p-3 text-left">Transliteración</th>
                                                        <th class="p-3 text-left">Forma</th>
                                                        <th class="p-3 text-left">Función</th>
                                                        <th class="p-3 text-left">Significado</th>
                                                    </tr>
                                                </thead>
                                                <tbody>
                                                    <tr class="border-b border-discord-input/30">
                                                        <td class="p-3 font-hebrew text-lg">בְּרֵאשִׁית</td>
                                                        <td class="p-3">b'reshit</td>
                                                        <td class="p-3">
                                                            <span class="badge badge-primary">Prep + Sust</span>
                                                        </td>
                                                        <td class="p-3">Circunstancia temporal</td>
                                                        <td class="p-3">en el principio</td>
                                                    </tr>
                                                    <tr class="border-b border-discord-input/30">
                                                        <td class="p-3 font-hebrew text-lg">בָּרָא</td>
                                                        <td class="p-3">bara</td>
                                                        <td class="p-3">
                                                            <span class="badge badge-success">Verbo Qal</span>
                                                        </td>
                                                        <td class="p-3">Predicado principal</td>
                                                        <td class="p-3">creó, formó</td>
                                                    </tr>
                                                    <tr class="border-b border-discord-input/30">
                                                        <td class="p-3 font-hebrew text-lg">אֱלֹהִים</td>
                                                        <td class="p-3">Elohim</td>
                                                        <td class="p-3">
                                                            <span class="badge badge-warning">Sust masc pl</span>
                                                        </td>
                                                        <td class="p-3">Sujeto</td>
                                                        <td class="p-3">Dios</td>
                                                    </tr>
                                                    <tr class="border-b border-discord-input/30">
                                                        <td class="p-3 font-hebrew text-lg">אֵת</td>
                                                        <td class="p-3">et</td>
                                                        <td class="p-3">
                                                            <span class="badge badge-error">Partícula</span>
                                                        </td>
                                                        <td class="p-3">Marcador de OD</td>
                                                        <td class="p-3">(marca objeto directo)</td>
                                                    </tr>
                                                    <tr class="border-b border-discord-input/30">
                                                        <td class="p-3 font-hebrew text-lg">הַשָּׁמַיִם</td>
                                                        <td class="p-3">hashamayim</td>
                                                        <td class="p-3">
                                                            <span class="badge badge-warning">Art + Sust</span>
                                                        </td>
                                                        <td class="p-3">Objeto directo 1</td>
                                                        <td class="p-3">los cielos</td>
                                                    </tr>
                                                </tbody>
                                            </table>
                                        </div>
                                    </div>
                                    
                                    <!-- Notas textuales -->
                                    <div class="discord-card p-4 rounded-lg">
                                        <h5 class="font-medium mb-3 flex items-center">
                                            <i class="fas fa-sticky-note mr-2"></i>
                                            Notas textuales y críticas
                                        </h5>
                                        
                                        <div class="space-y-4 text-sm">
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <h6 class="font-medium mb-2">בְּרֵאשִׁית (B'reshit) - "En el principio"</h6>
                                                <p class="mb-2">Esta palabra aparece solo aquí en la Biblia en forma absoluta. Algunos eruditos proponen traducir "Cuando Dios comenzó a crear..." pero la tradición masorética y la mayoría de traducciones mantienen "En el principio".</p>
                                                <p class="discord-text-secondary">
                                                    <strong>Raíz:</strong> ראש (rosh) - cabeza, principio<br>
                                                    <strong>Forma:</strong> Constructo con preposición ב
                                                </p>
                                            </div>
                                            
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <h6 class="font-medium mb-2">בָּרָא (bara) - "creó"</h6>
                                                <p class="mb-2">Este verbo se usa exclusivamente para la actividad creativa divina en el AT. Nunca tiene como sujeto a seres humanos, enfatizando que solo Dios puede crear ex nihilo.</p>
                                                <p class="discord-text-secondary">
                                                    <strong>Apariciones:</strong> 54 veces en el AT<br>
                                                    <strong>Siempre con Dios como sujeto</strong>
                                                </p>
                                            </div>
                                            
                                            <div class="p-3 bg-discord-input/20 rounded">
                                                <h6 class="font-medium mb-2">אֱלֹהִים (Elohim) - "Dios"</h6>
                                                <p class="mb-2">Forma plural de אֵל (El), pero usado con verbo singular, indicando la majestad divina. Es el nombre genérico para Dios en Génesis 1, contrastando con יהוה (YHWH) en Génesis 2.</p>
                                                <p class="discord-text-secondary">
                                                    <strong>Plural de majestad</strong><br>
                                                    <strong>2,570 apariciones en el AT</strong>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Panel lateral de herramientas de estudio -->
                    <div class="xl:col-span-1">
                        <div class="space-y-4">
                            <!-- Herramientas activas -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-wrench mr-2"></i>
                                    Herramientas Activas
                                </h4>
                                
                                <div class="space-y-2">
                                    <div class="flex items-center justify-between p-2 bg-discord-input/20 rounded">
                                        <div class="flex items-center">
                                            <i class="fas fa-highlighter mr-2 text-discord-warning"></i>
                                            <span class="text-sm">Resaltador</span>
                                        </div>
                                        <button class="text-xs discord-button-secondary px-2 py-1 rounded">OFF</button>
                                    </div>
                                    
                                    <div class="flex items-center justify-between p-2 bg-discord-input/20 rounded">
                                        <div class="flex items-center">
                                            <i class="fas fa-sticky-note mr-2 text-discord-success"></i>
                                            <span class="text-sm">Notas rápidas</span>
                                        </div>
                                        <button class="text-xs discord-button-secondary px-2 py-1 rounded">ON</button>
                                    </div>
                                    
                                    <div class="flex items-center justify-between p-2 bg-discord-input/20 rounded">
                                        <div class="flex items-center">
                                            <i class="fas fa-link mr-2 text-discord-primary"></i>
                                            <span class="text-sm">Referencias</span>
                                        </div>
                                        <button class="text-xs discord-button-secondary px-2 py-1 rounded">ON</button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Progreso de estudio -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-chart-line mr-2"></i>
                                    Progreso de Estudio
                                </h4>
                                
                                <div class="space-y-4">
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm">Génesis completado</span>
                                            <span class="text-sm discord-text-secondary">15%</span>
                                        </div>
                                        <div class="progress-bar">
                                            <div class="progress-fill w-[15%]"></div>
                                        </div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm">Notas tomadas</span>
                                            <span class="text-sm discord-text-secondary">23</span>
                                        </div>
                                        <div class="text-xs discord-text-secondary">Última: hace 5 min</div>
                                    </div>
                                    
                                    <div>
                                        <div class="flex justify-between mb-1">
                                            <span class="text-sm">Tiempo de estudio</span>
                                            <span class="text-sm discord-text-secondary">2h 15m</span>
                                        </div>
                                        <div class="text-xs discord-text-secondary">Hoy: 45 minutos</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Búsqueda inteligente -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-brain mr-2"></i>
                                    Búsqueda Inteligente
                                </h4>
                                
                                <div class="space-y-3">
                                    <div>
                                        <input type="text" id="busqueda-inteligente" class="w-full discord-input text-sm rounded px-2 py-1" placeholder="Buscar conceptos, temas...">
                                    </div>
                                    
                                    <div>
                                        <label class="text-xs discord-text-secondary">Filtros</label>
                                        <div class="flex flex-wrap gap-1 mt-1">
                                            <button class="badge badge-primary cursor-pointer text-xs">Narrativa</button>
                                            <button class="badge badge-secondary cursor-pointer text-xs">Poesía</button>
                                            <button class="badge badge-secondary cursor-pointer text-xs">Profético</button>
                                            <button class="badge badge-secondary cursor-pointer text-xs">Ley</button>
                                        </div>
                                    </div>
                                    
                                    <button class="w-full discord-button-primary px-3 py-2 rounded text-sm">
                                        <i class="fas fa-search mr-2"></i>Buscar con IA
                                    </button>
                                </div>
                                
                                <!-- Resultados recientes -->
                                <div class="mt-4 space-y-2">
                                    <div class="text-xs discord-text-secondary">Búsquedas recientes:</div>
                                    <div class="space-y-1">
                                        <button class="w-full text-left text-xs p-2 bg-discord-input/20 rounded hover:bg-discord-input/40">
                                            "pacto con Abraham"
                                        </button>
                                        <button class="w-full text-left text-xs p-2 bg-discord-input/20 rounded hover:bg-discord-input/40">
                                            "simbolismo del agua"
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Recursos relacionados -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-link mr-2"></i>
                                    Recursos Relacionados
                                </h4>
                                
                                <div class="space-y-2">
                                    <a href="#" class="block p-2 bg-discord-input/20 rounded hover:bg-discord-input/40 transition-colors">
                                        <div class="text-sm font-medium">Mapa: Mesopotamia Antigua</div>
                                        <div class="text-xs discord-text-secondary">Contexto geográfico de Génesis</div>
                                    </a>
                                    
                                    <a href="#" class="block p-2 bg-discord-input/20 rounded hover:bg-discord-input/40 transition-colors">
                                        <div class="text-sm font-medium">Cronología: Patriarcas</div>
                                        <div class="text-xs discord-text-secondary">Línea de tiempo bíblica</div>
                                    </a>
                                    
                                    <a href="#" class="block p-2 bg-discord-input/20 rounded hover:bg-discord-input/40 transition-colors">
                                        <div class="text-sm font-medium">Arqueología: Tell es-Sultan</div>
                                        <div class="text-xs discord-text-secondary">Jericó en tiempos bíblicos</div>
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- [Continuará con los demás contenedores mejorados...] -->
            <!-- Por limitaciones de espacio, aquí continúo con una versión condensada de las demás secciones -->
            
            <!-- Contenedor de Filtros (Versión mejorada compacta) -->
            <div id="content-filtros" class="animate-fadeIn hidden">
                <div class="space-y-6">
                    <div class="text-center">
                        <h2 class="text-3xl font-bold mb-2">Filtros Analíticos Avanzados</h2>
                        <p class="discord-text-secondary">Herramientas de análisis temático y conceptual</p>
                    </div>
                    
                    <!-- Panel de filtros mejorado será implementado aquí -->
                    <div class="discord-card p-6 rounded-lg">
                        <p class="text-center discord-text-secondary">Sistema de filtros avanzados en desarrollo...</p>
                    </div>
                </div>
            </div>
            
            <!-- Contenedor Social (Masivamente expandido) -->
            <div id="content-social" class="animate-fadeIn hidden">
                <div class="grid grid-cols-1 lg:grid-cols-4 gap-6">
                    <!-- Lista de canales -->
                    <div class="lg:col-span-1">
                        <div class="discord-card p-4 rounded-lg sticky top-24">
                            <h3 class="font-semibold mb-4 flex items-center">
                                <i class="fas fa-users mr-2"></i>
                                Comunidades
                            </h3>
                            
                            <!-- Canales de chat -->
                            <div class="space-y-2 mb-6">
                                <div class="text-xs discord-text-secondary uppercase font-semibold">Estudios Generales</div>
                                <button class="w-full text-left p-2 rounded hover:bg-discord-input/20 flex items-center">
                                    <i class="fas fa-hashtag mr-2 text-discord-muted"></i>
                                    <span class="text-sm">general</span>
                                </button>
                                <button class="w-full text-left p-2 rounded hover:bg-discord-input/20 flex items-center">
                                    <i class="fas fa-hashtag mr-2 text-discord-muted"></i>
                                    <span class="text-sm">preguntas</span>
                                </button>
                                <button class="w-full text-left p-2 rounded hover:bg-discord-input/20 flex items-center">
                                    <i class="fas fa-hashtag mr-2 text-discord-muted"></i>
                                    <span class="text-sm">recursos</span>
                                </button>
                            </div>
                            
                            <div class="space-y-2 mb-6">
                                <div class="text-xs discord-text-secondary uppercase font-semibold">Estudios Temáticos</div>
                                <button class="w-full text-left p-2 rounded hover:bg-discord-input/20 flex items-center">
                                    <i class="fas fa-hashtag mr-2 text-discord-muted"></i>
                                    <span class="text-sm">profecía</span>
                                </button>
                                <button class="w-full text-left p-2 rounded hover:bg-discord-input/20 flex items-center">
                                    <i class="fas fa-hashtag mr-2 text-discord-muted"></i>
                                    <span class="text-sm">apologética</span>
                                </button>
                            </div>
                            
                            <!-- Usuarios conectados -->
                            <div class="space-y-2">
                                <div class="text-xs discord-text-secondary uppercase font-semibold">En línea - 12</div>
                                <div class="space-y-1">
                                    <div class="flex items-center p-1">
                                        <div class="w-8 h-8 bg-discord-primary rounded-full flex items-center justify-center mr-2">
                                            <span class="text-xs">MG</span>
                                        </div>
                                        <span class="text-sm">Miguel García</span>
                                        <div class="w-2 h-2 bg-discord-success rounded-full ml-auto"></div>
                                    </div>
                                    <div class="flex items-center p-1">
                                        <div class="w-8 h-8 bg-discord-success rounded-full flex items-center justify-center mr-2">
                                            <span class="text-xs">AL</span>
                                        </div>
                                        <span class="text-sm">Ana López</span>
                                        <div class="w-2 h-2 bg-discord-success rounded-full ml-auto"></div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Chat principal -->
                    <div class="lg:col-span-2">
                        <div class="discord-card rounded-lg h-[600px] flex flex-col">
                            <!-- Header del chat -->
                            <div class="p-4 border-b border-discord-input">
                                <div class="flex items-center justify-between">
                                    <div class="flex items-center">
                                        <i class="fas fa-hashtag mr-2 text-discord-muted"></i>
                                        <h3 class="font-semibold">general</h3>
                                        <span class="ml-2 text-sm discord-text-secondary">147 miembros</span>
                                    </div>
                                    <div class="flex items-center space-x-2">
                                        <button class="p-2 hover:bg-discord-input/20 rounded tooltip" data-tooltip="Buscar">
                                            <i class="fas fa-search"></i>
                                        </button>
                                        <button class="p-2 hover:bg-discord-input/20 rounded tooltip" data-tooltip="Notificaciones">
                                            <i class="fas fa-bell"></i>
                                        </button>
                                        <button class="p-2 hover:bg-discord-input/20 rounded tooltip" data-tooltip="Configuración">
                                            <i class="fas fa-cog"></i>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Mensajes -->
                            <div class="flex-grow overflow-y-auto p-4 space-y-4" id="chat-mensajes">
                                <!-- Mensaje de ejemplo -->
                                <div class="mensaje-chat">
                                    <div class="flex items-start">
                                        <div class="w-10 h-10 bg-discord-primary rounded-full flex items-center justify-center mr-3">
                                            <span class="text-sm">MG</span>
                                        </div>
                                        <div class="flex-grow">
                                            <div class="flex items-center mb-1">
                                                <span class="font-semibold">Miguel García</span>
                                                <span class="ml-2 text-xs discord-text-secondary">hace 5 min</span>
                                            </div>
                                            <p class="text-sm">Estoy estudiando Génesis 1 y me pregunto sobre la relación entre "bara" y "asah". ¿Alguien puede explicar la diferencia?</p>
                                            <div class="flex items-center mt-2 space-x-2">
                                                <button class="text-xs discord-text-secondary hover:text-discord-primary">
                                                    <i class="fas fa-thumbs-up mr-1"></i>3
                                                </button>
                                                <button class="text-xs discord-text-secondary hover:text-discord-primary">
                                                    <i class="fas fa-reply mr-1"></i>Responder
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="mensaje-chat">
                                    <div class="flex items-start">
                                        <div class="w-10 h-10 bg-discord-success rounded-full flex items-center justify-center mr-3">
                                            <span class="text-sm">AL</span>
                                        </div>
                                        <div class="flex-grow">
                                            <div class="flex items-center mb-1">
                                                <span class="font-semibold">Ana López</span>
                                                <span class="ml-2 text-xs discord-text-secondary">hace 3 min</span>
                                            </div>
                                            <p class="text-sm">¡Excelente pregunta! "Bara" (בָּרָא) se usa para la creación ex nihilo - crear de la nada. "Asah" (עָשָׂה) es más general y puede significar hacer o formar algo a partir de material existente.</p>
                                            <div class="mt-2 p-3 bg-discord-input/30 rounded">
                                                <div class="text-xs discord-text-secondary mb-1">Referencia bíblica</div>
                                                <p class="text-sm font-medium">Génesis 1:1 - "bara" (creó)</p>
                                                <p class="text-sm font-medium">Génesis 1:7 - "asah" (hizo)</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Input de mensaje -->
                            <div class="p-4 border-t border-discord-input">
                                <div class="flex items-end space-x-2">
                                    <button class="p-2 discord-button-secondary rounded">
                                        <i class="fas fa-plus"></i>
                                    </button>
                                    <div class="flex-grow">
                                        <textarea id="mensaje-input" class="w-full discord-input text-base rounded px-3 py-2 resize-none" rows="1" placeholder="Escribe un mensaje..."></textarea>
                                    </div>
                                    <button class="p-2 discord-button-secondary rounded tooltip" data-tooltip="Emoji">
                                        <i class="fas fa-smile"></i>
                                    </button>
                                    <button id="enviar-mensaje-btn" class="p-2 discord-button-primary rounded">
                                        <i class="fas fa-paper-plane"></i>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Panel de información -->
                    <div class="lg:col-span-1">
                        <div class="space-y-4">
                            <!-- Información del canal -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3">Información del Canal</h4>
                                <p class="text-sm discord-text-secondary mb-3">Canal principal para discusiones generales sobre estudios bíblicos.</p>
                                <div class="space-y-2 text-sm">
                                    <div class="flex justify-between">
                                        <span>Creado:</span>
                                        <span class="discord-text-secondary">15 Ene 2025</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Mensajes:</span>
                                        <span class="discord-text-secondary">2,847</span>
                                    </div>
                                    <div class="flex justify-between">
                                        <span>Miembros:</span>
                                        <span class="discord-text-secondary">147</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Eventos próximos -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-calendar mr-2"></i>
                                    Próximos Eventos
                                </h4>
                                <div class="space-y-3">
                                    <div class="p-3 bg-discord-input/20 rounded">
                                        <div class="font-medium text-sm">Estudio: Profecías Mesiánicas</div>
                                        <div class="text-xs discord-text-secondary">Viernes 7:00 PM</div>
                                        <div class="text-xs discord-text-secondary">con Dr. Martínez</div>
                                    </div>
                                    <div class="p-3 bg-discord-input/20 rounded">
                                        <div class="font-medium text-sm">Q&A: Apologética</div>
                                        <div class="text-xs discord-text-secondary">Sábado 2:00 PM</div>
                                        <div class="text-xs discord-text-secondary">Sesión abierta</div>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- Recursos compartidos -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-paperclip mr-2"></i>
                                    Archivos Recientes
                                </h4>
                                <div class="space-y-2">
                                    <div class="flex items-center p-2 bg-discord-input/20 rounded">
                                        <i class="fas fa-file-pdf text-red-500 mr-2"></i>
                                        <div class="flex-grow">
                                            <div class="text-sm">Cronología_Reyes.pdf</div>
                                            <div class="text-xs discord-text-secondary">Ana López</div>
                                        </div>
                                    </div>
                                    <div class="flex items-center p-2 bg-discord-input/20 rounded">
                                        <i class="fas fa-image text-green-500 mr-2"></i>
                                        <div class="flex-grow">
                                            <div class="text-sm">Mapa_Palestina.jpg</div>
                                            <div class="text-xs discord-text-secondary">Miguel García</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Contenedor de IA (Nueva sección) -->
            <div id="content-ai" class="animate-fadeIn hidden">
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                    <!-- Panel principal de IA -->
                    <div class="lg:col-span-2">
                        <div class="discord-card p-6 rounded-lg">
                            <div class="text-center mb-6">
                                <div class="w-16 h-16 bg-gradient-to-r from-discord-primary to-purple-600 rounded-full flex items-center justify-center mx-auto mb-4">
                                    <i class="fas fa-robot text-white text-2xl"></i>
                                </div>
                                <h2 class="text-2xl font-bold mb-2">Asistente Bíblico IA</h2>
                                <p class="discord-text-secondary">Análisis inteligente, interpretación y respuestas a tus preguntas bíblicas</p>
                            </div>
                            
                            <!-- Chat con IA -->
                            <div class="border border-discord-input rounded-lg overflow-hidden">
                                <!-- Header del chat IA -->
                                <div class="bg-discord-input/50 p-4 border-b border-discord-input">
                                    <div class="flex items-center justify-between">
                                        <div class="flex items-center">
                                            <div class="w-8 h-8 bg-gradient-to-r from-discord-primary to-purple-600 rounded-full flex items-center justify-center mr-3">
                                                <i class="fas fa-robot text-white text-sm"></i>
                                            </div>
                                            <div>
                                                <h4 class="font-medium">TeólogoIA</h4>
                                                <div class="text-xs discord-text-secondary flex items-center">
                                                    <div class="w-2 h-2 bg-green-500 rounded-full mr-1"></div>
                                                    En línea
                                                </div>
                                            </div>
                                        </div>
                                        <div class="flex items-center space-x-2">
                                            <button class="discord-button-secondary px-3 py-1 rounded text-xs" id="nueva-conversacion-btn">
                                                <i class="fas fa-plus mr-1"></i>Nueva
                                            </button>
                                            <button class="discord-button-secondary px-3 py-1 rounded text-xs" id="guardar-conversacion-btn">
                                                <i class="fas fa-save mr-1"></i>Guardar
                                            </button>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Mensajes del chat IA -->
                                <div class="h-96 overflow-y-auto p-4 space-y-4" id="chat-ia-mensajes">
                                    <!-- Mensaje de bienvenida -->
                                    <div class="flex items-start">
                                        <div class="w-8 h-8 bg-gradient-to-r from-discord-primary to-purple-600 rounded-full flex items-center justify-center mr-3">
                                            <i class="fas fa-robot text-white text-xs"></i>
                                        </div>
                                        <div class="flex-grow">
                                            <div class="bg-discord-input/30 rounded-lg p-3">
                                                <p class="text-sm mb-2">¡Hola! Soy TeólogoIA, tu asistente para estudios bíblicos. Puedo ayudarte con:</p>
                                                <ul class="text-sm space-y-1 list-disc list-inside discord-text-secondary">
                                                    <li>Interpretación de pasajes bíblicos</li>
                                                    <li>Análisis exegético y hermenéutico</li>
                                                    <li>Conexiones temáticas entre textos</li>
                                                    <li>Contexto histórico y cultural</li>
                                                    <li>Comparación de traducciones</li>
                                                </ul>
                                                <p class="text-sm mt-2">¿En qué puedo ayudarte hoy?</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <!-- Input para IA -->
                                <div class="p-4 border-t border-discord-input bg-discord-input/20">
                                    <div class="flex items-end space-x-2">
                                        <div class="flex-grow">
                                            <textarea id="ia-input" class="w-full discord-input text-base rounded px-3 py-2 resize-none" rows="2" placeholder="Pregunta algo sobre la Biblia..."></textarea>
                                        </div>
                                        <button id="enviar-ia-btn" class="discord-button-primary px-4 py-2 rounded">
                                            <i class="fas fa-paper-plane"></i>
                                        </button>
                                    </div>
                                    
                                    <!-- Sugerencias de preguntas -->
                                    <div class="mt-3">
                                        <div class="text-xs discord-text-secondary mb-2">Preguntas sugeridas:</div>
                                        <div class="flex flex-wrap gap-2">
                                            <button class="bg-discord-input/50 hover:bg-discord-input text-xs px-2 py-1 rounded pregunta-sugerida">
                                                ¿Qué significa "bara" en Génesis 1:1?
                                            </button>
                                            <button class="bg-discord-input/50 hover:bg-discord-input text-xs px-2 py-1 rounded pregunta-sugerida">
                                                Explica el contexto de Juan 3:16
                                            </button>
                                            <button class="bg-discord-input/50 hover:bg-discord-input text-xs px-2 py-1 rounded pregunta-sugerida">
                                                ¿Cuáles son las profecías mesiánicas?
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Panel de funciones IA -->
                    <div class="lg:col-span-1">
                        <div class="space-y-4">
                            <!-- Herramientas IA -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-magic mr-2"></i>
                                    Herramientas IA
                                </h4>
                                
                                <div class="space-y-2">
                                    <button class="w-full discord-button-secondary px-3 py-2 rounded text-sm text-left" id="ia-interpretar-btn">
                                        <i class="fas fa-search mr-2"></i>Interpretar pasaje
                                    </button>
                                    
                                    <button class="w-full discord-button-secondary px-3 py-2 rounded text-sm text-left" id="ia-conectar-btn">
                                        <i class="fas fa-link mr-2"></i>Conectar temas
                                    </button>
                                    
                                    <button class="w-full discord-button-secondary px-3 py-2 rounded text-sm text-left" id="ia-resumir-btn">
                                        <i class="fas fa-compress mr-2"></i>Resumir capítulo
                                    </button>
                                    
                                    <button class="w-full discord-button-secondary px-3 py-2 rounded text-sm text-left" id="ia-preguntas-btn">
                                        <i class="fas fa-question-circle mr-2"></i>Generar preguntas
                                    </button>
                                    
                                    <button class="w-full discord-button-secondary px-3 py-2 rounded text-sm text-left" id="ia-plan-btn">
                                        <i class="fas fa-calendar mr-2"></i>Crear plan de estudio
                                    </button>
                                </div>
                            </div>
                            
                            <!-- Historial de conversaciones -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-history mr-2"></i>
                                    Conversaciones Recientes
                                </h4>
                                
                                <div class="space-y-2">
                                    <div class="p-3 bg-discord-input/20 rounded cursor-pointer hover:bg-discord-input/40">
                                        <div class="text-sm font-medium">Análisis de Génesis 1</div>
                                        <div class="text-xs discord-text-secondary">hace 2 horas</div>
                                    </div>
                                    
                                    <div class="p-3 bg-discord-input/20 rounded cursor-pointer hover:bg-discord-input/40">
                                        <div class="text-sm font-medium">Profecías mesiánicas</div>
                                        <div class="text-xs discord-text-secondary">ayer</div>
                                    </div>
                                    
                                    <div class="p-3 bg-discord-input/20 rounded cursor-pointer hover:bg-discord-input/40">
                                        <div class="text-sm font-medium">Parábolas de Jesús</div>
                                        <div class="text-xs discord-text-secondary">hace 3 días</div>
                                    </div>
                                </div>
                                
                                <button class="w-full mt-3 discord-button-secondary px-3 py-2 rounded text-sm">
                                    Ver todas
                                </button>
                            </div>
                            
                            <!-- Configuración IA -->
                            <div class="discord-card p-4 rounded-lg">
                                <h4 class="font-medium mb-3 flex items-center">
                                    <i class="fas fa-cog mr-2"></i>
                                    Configuración
                                </h4>
                                
                                <div class="space-y-3">
                                    <div>
                                        <label class="text-sm discord-text-secondary">Estilo de respuesta</label>
                                        <select id="ia-estilo" class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                            <option value="academico">Académico</option>
                                            <option value="conversacional">Conversacional</option>
                                            <option value="devocional">Devocional</option>
                                            <option value="pastoral">Pastoral</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="text-sm discord-text-secondary">Nivel de detalle</label>
                                        <select id="ia-detalle" class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                            <option value="basico">Básico</option>
                                            <option value="intermedio">Intermedio</option>
                                            <option value="avanzado">Avanzado</option>
                                        </select>
                                    </div>
                                    
                                    <div>
                                        <label class="text-sm discord-text-secondary">Tradición teológica</label>
                                        <select id="ia-tradicion" class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                            <option value="ninguna">Ninguna preferencia</option>
                                            <option value="reformada">Reformada</option>
                                            <option value="arminiana">Arminiana</option>
                                            <option value="catolica">Católica</option>
                                            <option value="ortodoxa">Ortodoxa</option>
                                        </select>
                                    </div>
                                    
                                    <div class="flex items-center">
                                        <input type="checkbox" id="ia-referencias" class="mr-2">
                                        <label class="text-sm">Incluir referencias cruzadas</label>
                                    </div>
                                    
                                    <div class="flex items-center">
                                        <input type="checkbox" id="ia-original" class="mr-2">
                                        <label class="text-sm">Incluir idiomas originales</label>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Contenedor de Estadísticas (Nueva sección) -->
            <div id="content-estadisticas" class="animate-fadeIn hidden">
                <div class="space-y-6">
                    <!-- Header de estadísticas -->
                    <div class="text-center">
                        <h2 class="text-3xl font-bold mb-2">Estadísticas y Analytics</h2>
                        <p class="discord-text-secondary">Análisis detallado de tu progreso y uso de la plataforma</p>
                    </div>
                    
                    <!-- Dashboard principal -->
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
                        <!-- Métricas principales -->
                        <div class="discord-card p-4 rounded-lg text-center">
                            <div class="text-3xl font-bold text-discord-primary mb-2">156</div>
                            <div class="text-sm discord-text-secondary">Capítulos leídos</div>
                            <div class="text-xs text-discord-success mt-1">+12 esta semana</div>
                        </div>
                        
                        <div class="discord-card p-4 rounded-lg text-center">
                            <div class="text-3xl font-bold text-discord-success mb-2">47h</div>
                            <div class="text-sm discord-text-secondary">Tiempo de estudio</div>
                            <div class="text-xs text-discord-success mt-1">+3h esta semana</div>
                        </div>
                        
                        <div class="discord-card p-4 rounded-lg text-center">
                            <div class="text-3xl font-bold text-discord-warning mb-2">89</div>
                            <div class="text-sm discord-text-secondary">Notas tomadas</div>
                            <div class="text-xs text-discord-success mt-1">+7 esta semana</div>
                        </div>
                        
                        <div class="discord-card p-4 rounded-lg text-center">
                            <div class="text-3xl font-bold text-purple-500 mb-2">23</div>
                            <div class="text-sm discord-text-secondary">Días consecutivos</div>
                            <div class="text-xs text-discord-success mt-1">Nuevo récord!</div>
                        </div>
                    </div>
                    
                    <!-- Gráficos y análisis -->
                    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                        <!-- Progreso semanal -->
                        <div class="discord-card p-6 rounded-lg">
                            <h3 class="text-xl font-semibold mb-4">Progreso Semanal</h3>
                            <div class="h-64">
                                <canvas id="grafico-progreso-semanal"></canvas>
                            </div>
                        </div>
                        
                        <!-- Distribución por libros -->
                        <div class="discord-card p-6 rounded-lg">
                            <h3 class="text-xl font-semibold mb-4">Libros Más Estudiados</h3>
                            <div class="h-64">
                                <canvas id="grafico-libros-estudiados"></canvas>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Logros y insignias -->
                    <div class="discord-card p-6 rounded-lg">
                        <h3 class="text-xl font-semibold mb-4 flex items-center">
                            <i class="fas fa-trophy mr-2 text-yellow-500"></i>
                            Logros y Insignias
                        </h3>
                        
                        <div class="grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4">
                            <!-- Logro desbloqueado -->
                            <div class="text-center p-4 bg-discord-success/20 border-2 border-discord-success rounded-lg">
                                <div class="w-12 h-12 bg-discord-success rounded-full flex items-center justify-center mx-auto mb-2">
                                    <i class="fas fa-book text-white"></i>
                                </div>
                                <div class="text-sm font-medium">Primer Libro</div>
                                <div class="text-xs discord-text-secondary">Completaste Génesis</div>
                            </div>
                            
                            <!-- Logro desbloqueado -->
                            <div class="text-center p-4 bg-discord-primary/20 border-2 border-discord-primary rounded-lg">
                                <div class="w-12 h-12 bg-discord-primary rounded-full flex items-center justify-center mx-auto mb-2">
                                    <i class="fas fa-fire text-white"></i>
                                </div>
                                <div class="text-sm font-medium">Racha Caliente</div>
                                <div class="text-xs discord-text-secondary">7 días consecutivos</div>
                            </div>
                            
                            <!-- Logro desbloqueado -->
                            <div class="text-center p-4 bg-discord-warning/20 border-2 border-discord-warning rounded-lg">
                                <div class="w-12 h-12 bg-discord-warning rounded-full flex items-center justify-center mx-auto mb-2">
                                    <i class="fas fa-pen text-discord-tertiary"></i>
                                </div>
                                <div class="text-sm font-medium">Escritor</div>
                                <div class="text-xs discord-text-secondary">50 notas creadas</div>
                            </div>
                            
                            <!-- Logro bloqueado -->
                            <div class="text-center p-4 bg-discord-input/20 border-2 border-discord-input rounded-lg opacity-50">
                                <div class="w-12 h-12 bg-discord-input rounded-full flex items-center justify-center mx-auto mb-2">
                                    <i class="fas fa-crown text-discord-text-secondary"></i>
                                </div>
                                <div class="text-sm font-medium">Maestro</div>
                                <div class="text-xs discord-text-secondary">Completar 10 libros</div>
                            </div>
                            
                            <!-- Logro bloqueado -->
                            <div class="text-center p-4 bg-discord-input/20 border-2 border-discord-input rounded-lg opacity-50">
                                <div class="w-12 h-12 bg-discord-input rounded-full flex items-center justify-center mx-auto mb-2">
                                    <i class="fas fa-graduation-cap text-discord-text-secondary"></i>
                                </div>
                                <div class="text-sm font-medium">Erudito</div>
                                <div class="text-xs discord-text-secondary">100 horas de estudio</div>
                            </div>
                            
                            <!-- Logro bloqueado -->
                            <div class="text-center p-4 bg-discord-input/20 border-2 border-discord-input rounded-lg opacity-50">
                                <div class="w-12 h-12 bg-discord-input rounded-full flex items-center justify-center mx-auto mb-2">
                                    <i class="fas fa-star text-discord-text-secondary"></i>
                                </div>
                                <div class="text-sm font-medium">Estrella</div>
                                <div class="text-xs discord-text-secondary">Biblia completa</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Los demás contenedores continuarían con mejoras similares... -->
            <!-- [Contenido de Recursos y Filtros expandidos] -->
            
        </main>
        
        <!-- Pie de página mejorado -->
        <footer class="mt-12 py-8 border-t border-discord-input">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-6">
                <div>
                    <h4 class="font-semibold mb-3">Formación Bíblica</h4>
                    <p class="text-sm discord-text-secondary">Plataforma integral para el estudio profundo de las Escrituras con herramientas avanzadas de análisis.</p>
                </div>
                
                <div>
                    <h4 class="font-semibold mb-3">Recursos</h4>
                    <ul class="space-y-2 text-sm discord-text-secondary">
                        <li><a href="#" class="hover:text-discord-primary">Biblia Reina Valera 1960</a></li>
                        <li><a href="#" class="hover:text-discord-primary">Comentarios bíblicos</a></li>
                        <li><a href="#" class="hover:text-discord-primary">Concordancia Strong</a></li>
                        <li><a href="#" class="hover:text-discord-primary">Mapas y cronología</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-semibold mb-3">Comunidad</h4>
                    <ul class="space-y-2 text-sm discord-text-secondary">
                        <li><a href="#" class="hover:text-discord-primary">Grupos de estudio</a></li>
                        <li><a href="#" class="hover:text-discord-primary">Foros de discusión</a></li>
                        <li><a href="#" class="hover:text-discord-primary">Eventos en vivo</a></li>
                        <li><a href="#" class="hover:text-discord-primary">Mentores</a></li>
                    </ul>
                </div>
                
                <div>
                    <h4 class="font-semibold mb-3">Soporte</h4>
                    <ul class="space-y-2 text-sm discord-text-secondary">
                        <li><a href="#" class="hover:text-discord-primary">Centro de ayuda</a></li>
                        <li><a href="#" class="hover:text-discord-primary">Tutorials</a></li>
                        <li><a href="#" class="hover:text-discord-primary">Contacto</a></li>
                        <li><a href="#" class="hover:text-discord-primary">Feedback</a></li>
                    </ul>
                </div>
            </div>
            
            <div class="mt-8 pt-6 border-t border-discord-input text-center">
                <div class="flex flex-col md:flex-row justify-between items-center">
                    <p class="text-sm discord-text-muted">
                        &copy; 2025 Formación Bíblica Avanzada. Todos los derechos reservados.
                    </p>
                    <div class="flex items-center space-x-4 mt-4 md:mt-0">
                        <a href="#" class="text-sm discord-text-secondary hover:text-discord-primary">Privacidad</a>
                        <a href="#" class="text-sm discord-text-secondary hover:text-discord-primary">Términos</a>
                        <a href="#" class="text-sm discord-text-secondary hover:text-discord-primary">Cookies</a>
                    </div>
                </div>
                <p class="text-xs discord-text-muted mt-2">
                    Versión 2.0.1 - Última actualización: 15 de enero, 2025
                </p>
            </div>
        </footer>
    </div>
    
    <!-- Sistema de modales mejorado -->
    <div id="modal-overlay" class="fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 hidden">
        <div id="modal-container" class="discord-card rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden mx-4">
            <div id="modal-header" class="p-6 border-b border-discord-input">
                <div class="flex justify-between items-center">
                    <h3 id="modal-title" class="text-xl font-semibold"></h3>
                    <button id="modal-close-btn" class="discord-button-secondary p-2 rounded">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
            </div>
            <div id="modal-content" class="p-6 overflow-y-auto max-h-96">
                <!-- Contenido dinámico -->
            </div>
            <div id="modal-footer" class="p-6 border-t border-discord-input hidden">
                <!-- Botones dinámicos -->
            </div>
        </div>
    </div>
    
    <!-- Sistema de notificaciones mejorado -->
    <div id="notification-container" class="fixed top-4 right-4 z-40 space-y-2">
        <!-- Las notificaciones se agregarán dinámicamente -->
    </div>
    
    <!-- Sistema de tooltips -->
    <div id="tooltip" class="fixed bg-discord-secondary text-white text-sm px-2 py-1 rounded shadow-lg z-50 hidden pointer-events-none">
        <!-- Contenido del tooltip -->
    </div>
    
    <!-- Scripts principales -->
    <script>
        // Variables globales
        let currentTheme = 'dark';
        let currentUser = {
            name: 'Usuario',
            level: 1,
            xp: 150,
            totalStudyTime: 0,
            booksCompleted: 0,
            notesCount: 0
        };
        let currentBook = 'genesis';
        let currentChapter = 1;
        let studySession = {
            startTime: Date.now(),
            duration: 0
        };
        
        // Datos de la Biblia (simulado)
        const bibliaData = {
            genesis: {
                name: 'Génesis',
                chapters: 50,
                content: {
                    1: {
                        verses: [
                            'En el principio creó Dios los cielos y la tierra.',
                            'Y la tierra estaba desordenada y vacía, y las tinieblas estaban sobre la faz del abismo, y el Espíritu de Dios se movía sobre la faz de las aguas.',
                            'Y dijo Dios: Sea la luz; y fue la luz.',
                            'Y vio Dios que la luz era buena; y separó Dios la luz de las tinieblas.',
                            'Y llamó Dios a la luz Día, y a las tinieblas llamó Noche. Y fue la tarde y la mañana un día.'
                        ]
                    }
                }
            }
        };
        
        // Iniciálizar aplicación
        document.addEventListener('DOMContentLoaded', function() {
            console.log('🚀 Iniciando Formación Bíblica Avanzada v2.0');
            
            // Simular carga
            simulateLoading();
            
            // Detectar tema del sistema
            detectSystemTheme();
            
            // Inicializar todos los componentes
            setTimeout(() => {
                initializeComponents();
                showMainApp();
            }, 3000);
        });
        
        // Simular proceso de carga
        function simulateLoading() {
            const loadingProgress = document.getElementById('loading-progress');
            let progress = 0;
            
            const interval = setInterval(() => {
                progress += Math.random() * 15;
                if (progress >= 100) {
                    progress = 100;
                    clearInterval(interval);
                }
                
                if (loadingProgress) {
                    loadingProgress.style.width = progress + '%';
                }
            }, 200);
        }
        
        // Mostrar aplicación principal
        function showMainApp() {
            document.getElementById('loading-screen').classList.add('hidden');
            document.getElementById('main-app').classList.remove('hidden');
            
            // Iniciar temporizador de sesión
            startStudySession();
            
            // Mostrar notificación de bienvenida
            showNotification('¡Bienvenido de vuelta!', 'Tu sesión de estudio ha comenzado.', 'success');
        }
        
        // Detectar tema del sistema
        function detectSystemTheme() {
            if (window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches) {
                currentTheme = 'dark';
                document.documentElement.classList.add('dark');
                document.body.classList.remove('light');
            } else {
                currentTheme = 'light';
                document.documentElement.classList.remove('dark');
                document.body.classList.add('light');
            }
            
            // Actualizar icono de tema
            updateThemeIcon();
            
            // Escuchar cambios en el tema del sistema
            window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', event => {
                if (event.matches) {
                    setTheme('dark');
                } else {
                    setTheme('light');
                }
            });
        }
        
        // Cambiar tema
        function setTheme(theme) {
            currentTheme = theme;
            
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
                document.body.classList.remove('light');
            } else {
                document.documentElement.classList.remove('dark');
                document.body.classList.add('light');
            }
            
            updateThemeIcon();
            
            // Guardar preferencia
            localStorage.setItem('theme', theme);
        }
        
        // Actualizar icono de tema
        function updateThemeIcon() {
            const themeIcon = document.getElementById('theme-icon');
            if (themeIcon) {
                themeIcon.className = currentTheme === 'dark' ? 'fas fa-sun' : 'fas fa-moon';
            }
        }
        
        // Inicializar todos los componentes
        function initializeComponents() {
            initializeNavigation();
            initializeBible();
            initializeStudy();
            initializeFilters();
            initializeSocial();
            initializeAI();
            initializeStats();
            initializeSearch();
            initializeTooltips();
            initializeKeyboardShortcuts();
            initializeNotifications();
            
            console.log('✅ Todos los componentes inicializados');
        }
        
        // Inicializar navegación
        function initializeNavigation() {
            const navButtons = document.querySelectorAll('[id^="nav-"]');
            const contentSections = document.querySelectorAll('[id^="content-"]');
            
            navButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const sectionName = button.id.replace('nav-', '').replace('-btn', '');
                    showSection(sectionName);
                });
            });
            
            // Botón de tema
            document.getElementById('theme-toggle-btn')?.addEventListener('click', () => {
                setTheme(currentTheme === 'dark' ? 'light' : 'dark');
            });
            
            // Configuración de usuario
            document.getElementById('user-menu-btn')?.addEventListener('click', showUserMenu);
            document.getElementById('settings-btn')?.addEventListener('click', showSettings);
            document.getElementById('notifications-btn')?.addEventListener('click', showNotificationsPanel);
        }
        
        // Mostrar sección
        function showSection(sectionName) {
            // Ocultar todas las secciones
            document.querySelectorAll('[id^="content-"]').forEach(section => {
                section.classList.add('hidden');
            });
            
            // Mostrar sección seleccionada
            const targetSection = document.getElementById(`content-${sectionName}`);
            if (targetSection) {
                targetSection.classList.remove('hidden');
                targetSection.classList.add('animate-fadeIn');
            }
            
            // Actualizar botones de navegación
            document.querySelectorAll('[id^="nav-"]').forEach(btn => {
                btn.classList.remove('active');
            });
            
            const activeButton = document.getElementById(`nav-${sectionName}-btn`);
            if (activeButton) {
                activeButton.classList.add('active');
            }
            
            // Manejar navegación secundaria
            updateSecondaryNavigation(sectionName);
            
            // Cargar datos específicos de la sección
            loadSectionData(sectionName);
        }
        
        // Actualizar navegación secundaria
        function updateSecondaryNavigation(sectionName) {
            // Ocultar todos los botones secundarios
            document.querySelectorAll('#nav-secundaria button').forEach(btn => {
                btn.classList.add('hidden');
            });
            
            // Mostrar botones específicos según la sección
            switch(sectionName) {
                case 'social':
                    ['social-general-btn', 'social-teoria-btn', 'social-practica-btn'].forEach(id => {
                        document.getElementById(id)?.classList.remove('hidden');
                    });
                    break;
                case 'filtros':
                    ['filtro-sangre-btn', 'filtro-agua-btn'].forEach(id => {
                        document.getElementById(id)?.classList.remove('hidden');
                    });
                    break;
                case 'estudio':
                    ['estudio-comparar-btn', 'estudio-notas-btn'].forEach(id => {
                        document.getElementById(id)?.classList.remove('hidden');
                    });
                    break;
            }
        }
        
        // Cargar datos específicos de la sección
        function loadSectionData(sectionName) {
            switch(sectionName) {
                case 'biblia':
                    loadBibleContent();
                    break;
                case 'estadisticas':
                    loadStatsData();
                    break;
                case 'ai':
                    loadAIHistory();
                    break;
                case 'social':
                    loadSocialContent();
                    break;
            }
        }
        
        // Inicializar Biblia
        function initializeBible() {
            loadBibleBooks();
            setupBibleNavigation();
            setupBibleControls();
        }
        
        // Cargar libros de la Biblia
        function loadBibleBooks() {
            const librosAT = [
                'Génesis', 'Éxodo', 'Levítico', 'Números', 'Deuteronomio',
                'Josué', 'Jueces', 'Rut', '1 Samuel', '2 Samuel',
                '1 Reyes', '2 Reyes', '1 Crónicas', '2 Crónicas', 'Esdras',
                'Nehemías', 'Ester', 'Job', 'Salmos', 'Proverbios',
                'Eclesiastés', 'Cantares', 'Isaías', 'Jeremías', 'Lamentaciones',
                'Ezequiel', 'Daniel', 'Oseas', 'Joel', 'Amós',
                'Abdías', 'Jonás', 'Miqueas', 'Nahúm', 'Habacuc',
                'Sofonías', 'Hageo', 'Zacarías', 'Malaquías'
            ];
            
            const librosNT = [
                'Mateo', 'Marcos', 'Lucas', 'Juan', 'Hechos',
                'Romanos', '1 Corintios', '2 Corintios', 'Gálatas', 'Efesios',
                'Filipenses', 'Colosenses', '1 Tesalonicenses', '2 Tesalonicenses', '1 Timoteo',
                '2 Timoteo', 'Tito', 'Filemón', 'Hebreos', 'Santiago',
                '1 Pedro', '2 Pedro', '1 Juan', '2 Juan', '3 Juan',
                'Judas', 'Apocalipsis'
            ];
            
            const container = document.querySelector('#libros-container .libros-grid');
            if (container) {
                // Mostrar AT por defecto
                renderBooks(container, librosAT);
                
                // Configurar cambio entre testamentos
                document.getElementById('btn-antiguo-testamento')?.addEventListener('click', (e) => {
                    e.target.classList.add('active');
                    document.getElementById('btn-nuevo-testamento')?.classList.remove('active');
                    renderBooks(container, librosAT);
                });
                
                document.getElementById('btn-nuevo-testamento')?.addEventListener('click', (e) => {
                    e.target.classList.add('active');
                    document.getElementById('btn-antiguo-testamento')?.classList.remove('active');
                    renderBooks(container, librosNT);
                });
            }
        }
        
        // Renderizar libros
        function renderBooks(container, books) {
            container.innerHTML = '';
            books.forEach((libro, index) => {
                const bookElement = document.createElement('div');
                bookElement.className = 'libro-card';
                bookElement.textContent = libro;
                bookElement.addEventListener('click', () => selectBook(libro, index + 1));
                container.appendChild(bookElement);
            });
        }
        
        // Seleccionar libro
        function selectBook(bookName, bookNumber) {
            currentBook = bookName.toLowerCase();
            
            // Actualizar UI
            document.querySelectorAll('.libro-card').forEach(card => {
                card.classList.remove('seleccionado');
            });
            event.target.classList.add('seleccionado');
            
            // Cargar capítulos
            loadChapters(bookNumber);
            
            // Mostrar primer capítulo
            loadChapter(1);
        }
        
        // Cargar capítulos
        function loadChapters(totalChapters) {
            const select = document.getElementById('capitulo-select');
            if (select) {
                select.innerHTML = '';
                select.disabled = false;
                
                for (let i = 1; i <= totalChapters; i++) {
                    const option = document.createElement('option');
                    option.value = i;
                    option.textContent = `Capítulo ${i}`;
                    select.appendChild(option);
                }
                
                select.addEventListener('change', (e) => {
                    loadChapter(parseInt(e.target.value));
                });
            }
        }
        
        // Cargar capítulo
        function loadChapter(chapterNumber) {
            currentChapter = chapterNumber;
            
            // Actualizar título
            const titulo = document.getElementById('capitulo-titulo');
            if (titulo) {
                titulo.textContent = `${currentBook.charAt(0).toUpperCase() + currentBook.slice(1)} ${chapterNumber}`;
            }
            
            // Cargar contenido (simulado)
            loadBibleContent();
        }
        
        // Cargar contenido bíblico
        function loadBibleContent() {
            const container = document.getElementById('contenido-biblico');
            if (!container) return;
            
            // Simular carga de versículos
            const verses = bibliaData.genesis?.content?.[1]?.verses || [
                'En el principio creó Dios los cielos y la tierra.',
                'Y la tierra estaba desordenada y vacía, y las tinieblas estaban sobre la faz del abismo, y el Espíritu de Dios se movía sobre la faz de las aguas.',
                'Y dijo Dios: Sea la luz; y fue la luz.',
                'Y vio Dios que la luz era buena; y separó Dios la luz de las tinieblas.',
                'Y llamó Dios a la luz Día, y a las tinieblas llamó Noche. Y fue la tarde y la mañana un día.'
            ];
            
            container.innerHTML = '';
            
            verses.forEach((verse, index) => {
                const verseElement = document.createElement('div');
                verseElement.className = 'biblia-versiculo group hover:bg-discord-input/10 p-2 rounded cursor-pointer';
                verseElement.innerHTML = `
                    <span class="biblia-versiculo-numero">${index + 1}</span>
                    ${verse}
                    <div class="inline-flex ml-2 space-x-1 opacity-0 group-hover:opacity-100 transition-opacity">
                        <button class="text-xs p-1 hover:text-red-500 tooltip" data-tooltip="Agregar a favoritos" onclick="addToFavorites(${index + 1})">
                            <i class="fas fa-heart"></i>
                        </button>
                        <button class="text-xs p-1 hover:text-yellow-500 tooltip" data-tooltip="Destacar" onclick="highlightVerse(${index + 1})">
                            <i class="fas fa-highlighter"></i>
                        </button>
                        <button class="text-xs p-1 hover:text-green-500 tooltip" data-tooltip="Agregar nota" onclick="addNote(${index + 1})">
                            <i class="fas fa-sticky-note"></i>
                        </button>
                        <button class="text-xs p-1 hover:text-blue-500 tooltip" data-tooltip="Compartir" onclick="shareVerse(${index + 1})">
                            <i class="fas fa-share"></i>
                        </button>
                    </div>
                `;
                container.appendChild(verseElement);
            });
        }
        
        // Configurar controles de la Biblia
        function setupBibleControls() {
            // Navegación de capítulos
            document.getElementById('capitulo-anterior-btn')?.addEventListener('click', () => {
                if (currentChapter > 1) {
                    loadChapter(currentChapter - 1);
                }
            });
            
            document.getElementById('capitulo-siguiente-btn')?.addEventListener('click', () => {
                loadChapter(currentChapter + 1);
            });
            
            // Control de tamaño de texto
            let fontSize = 100;
            document.getElementById('disminuir-texto-btn')?.addEventListener('click', () => {
                if (fontSize > 75) {
                    fontSize -= 25;
                    updateFontSize(fontSize);
                }
            });
            
            document.getElementById('aumentar-texto-btn')?.addEventListener('click', () => {
                if (fontSize < 150) {
                    fontSize += 25;
                    updateFontSize(fontSize);
                }
            });
            
            // Ir a referencia
            document.getElementById('ir-referencia-btn')?.addEventListener('click', () => {
                const reference = document.getElementById('referencia-rapida')?.value;
                if (reference) {
                    goToReference(reference);
                }
            });
            
            // Audio
            document.getElementById('audio-play-btn')?.addEventListener('click', () => {
                playAudio();
            });
            
            // Compartir
            document.getElementById('compartir-capitulo-btn')?.addEventListener('click', () => {
                shareChapter();
            });
        }
        
        // Actualizar tamaño de fuente
        function updateFontSize(size) {
            const content = document.getElementById('contenido-biblico');
            if (content) {
                content.style.fontSize = `${size}%`;
            }
            
            const indicator = document.getElementById('tamano-texto-actual');
            if (indicator) {
                indicator.textContent = `${size}%`;
            }
        }
        
        // Funciones de versículos
        function addToFavorites(verseNumber) {
            showNotification('Favorito agregado', `${currentBook} ${currentChapter}:${verseNumber} agregado a favoritos.`, 'success');
        }
        
        function highlightVerse(verseNumber) {
            showNotification('Verso destacado', `${currentBook} ${currentChapter}:${verseNumber} destacado.`, 'warning');
        }
        
        function addNote(verseNumber) {
            showModal('Agregar Nota', `
                <div class="space-y-4">
                    <div>
                        <label class="text-sm discord-text-secondary">Referencia</label>
                        <input type="text" value="${currentBook} ${currentChapter}:${verseNumber}" class="w-full discord-input text-sm rounded px-2 py-1 mt-1" readonly>
                    </div>
                    <div>
                        <label class="text-sm discord-text-secondary">Nota</label>
                        <textarea class="w-full h-32 discord-input text-sm rounded px-2 py-1 mt-1" placeholder="Escribe tu nota aquí..."></textarea>
                    </div>
                    <div>
                        <label class="text-sm discord-text-secondary">Categoría</label>
                        <select class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                            <option>Reflexión personal</option>
                            <option>Pregunta</option>
                            <option>Conexión</option>
                            <option>Aplicación</option>
                        </select>
                    </div>
                </div>
            `, `
                <button onclick="closeModal()" class="discord-button-secondary px-4 py-2 rounded mr-2">Cancelar</button>
                <button onclick="saveNote(); closeModal();" class="discord-button-primary px-4 py-2 rounded">Guardar Nota</button>
            `);
        }
        
        function shareVerse(verseNumber) {
            const verseText = document.querySelector(`#contenido-biblico .biblia-versiculo:nth-child(${verseNumber})`);
            if (verseText) {
                const text = verseText.textContent.trim();
                const reference = `${currentBook} ${currentChapter}:${verseNumber}`;
                
                // Usar Web Share API si está disponible
                if (navigator.share) {
                    navigator.share({
                        title: reference,
                        text: text,
                        url: window.location.href
                    });
                } else {
                    // Fallback: copiar al portapapeles
                    navigator.clipboard.writeText(`"${text}" - ${reference}`);
                    showNotification('Copiado', 'Verso copiado al portapapeles.', 'success');
                }
            }
        }
        
        // Inicializar estudio
        function initializeStudy() {
            initializeTabs();
            initializeAnalysisTools();
            initializeComparisonTools();
        }
        
        // Inicializar tabs
        function initializeTabs() {
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');
            
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const targetTab = button.getAttribute('data-tab');
                    
                    // Actualizar botones
                    tabButtons.forEach(btn => {
                        btn.classList.remove('active', 'border-discord-primary');
                        btn.classList.add('border-transparent');
                    });
                    button.classList.add('active', 'border-discord-primary');
                    button.classList.remove('border-transparent');
                    
                    // Actualizar contenido
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                        content.classList.add('hidden');
                    });
                    
                    const targetContent = document.getElementById(`tab-${targetTab}`);
                    if (targetContent) {
                        targetContent.classList.add('active');
                        targetContent.classList.remove('hidden');
                    }
                });
            });
        }
        
        // Inicializar herramientas de análisis
        function initializeAnalysisTools() {
            document.getElementById('cargar-analisis-btn')?.addEventListener('click', () => {
                performTextAnalysis();
            });
        }
        
        // Realizar análisis de texto
        function performTextAnalysis() {
            const libro = document.getElementById('analisis-libro')?.value;
            const capitulo = document.getElementById('analisis-capitulo')?.value;
            const versiculos = document.getElementById('analisis-versiculos')?.value;
            
            showNotification('Análisis iniciado', 'Analizando el texto seleccionado...', 'info');
            
            // Simular análisis
            setTimeout(() => {
                showNotification('Análisis completado', 'El análisis textual se ha completado.', 'success');
            }, 2000);
        }
        
        // Inicializar herramientas de comparación
        function initializeComparisonTools() {
            document.getElementById('comparar-versiones-btn')?.addEventListener('click', () => {
                compareVersions();
            });
        }
        
        // Comparar versiones
        function compareVersions() {
            const versionPrincipal = document.getElementById('version-principal')?.value;
            const versionComparacion = document.getElementById('version-comparacion')?.value;
            const pasaje = document.getElementById('pasaje-comparacion')?.value;
            
            showNotification('Comparando versiones', `Comparando ${versionPrincipal} con ${versionComparacion}...`, 'info');
            
            // Simular comparación
            setTimeout(() => {
                showNotification('Comparación completada', 'Las versiones han sido comparadas.', 'success');
            }, 1500);
        }
        
        // Inicializar IA
        function initializeAI() {
            setupAIChat();
            setupAITools();
            setupAISuggestions();
        }
        
        // Configurar chat IA
        function setupAIChat() {
            const iaInput = document.getElementById('ia-input');
            const enviarBtn = document.getElementById('enviar-ia-btn');
            
            if (iaInput && enviarBtn) {
                enviarBtn.addEventListener('click', () => {
                    sendMessageToAI();
                });
                
                iaInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendMessageToAI();
                    }
                });
            }
            
            // Preguntas sugeridas
            document.querySelectorAll('.pregunta-sugerida').forEach(btn => {
                btn.addEventListener('click', () => {
                    if (iaInput) {
                        iaInput.value = btn.textContent;
                        sendMessageToAI();
                    }
                });
            });
        }
        
        // Enviar mensaje a la IA
        async function sendMessageToAI() {
            const input = document.getElementById('ia-input');
            const messagesContainer = document.getElementById('chat-ia-mensajes');
            
            if (!input || !messagesContainer || !input.value.trim()) return;
            
            const userMessage = input.value.trim();
            input.value = '';
            
            // Agregar mensaje del usuario
            addMessageToAIChat('user', userMessage);
            
            // Mostrar indicador de que la IA está escribiendo
            addTypingIndicator();
            
            try {
                // Usar la API de Poe para obtener respuesta
                const botMention = '@Claude-3.7-Sonnet';
                const prompt = `${botMention} Como un erudito bíblico experto, responde a esta pregunta sobre las Escrituras: ${userMessage}. 
                
                Por favor, proporciona:
                1. Una respuesta clara y académica
                2. Referencias bíblicas relevantes
                3. Contexto histórico/cultural cuando sea apropiado
                4. Aplicaciones prácticas si es relevante
                
                Mantén un tono respetuoso y centrado en las Escrituras.`;
                
                await window.Poe.sendUserMessage(prompt, {
                    handler: 'ai-response-handler',
                    stream: true,
                    openChat: false,
                    handlerContext: { userMessage: userMessage }
                });
                
            } catch (error) {
                console.error('Error al enviar mensaje a IA:', error);
                removeTypingIndicator();
                addMessageToAIChat('ai', 'Lo siento, hubo un error al procesar tu pregunta. Por favor, intenta de nuevo.');
            }
        }
        
        // Registrar manejador para respuestas de IA
        if (window.Poe) {
            window.Poe.registerHandler('ai-response-handler', (result, context) => {
                const msg = result.responses[0];
                
                if (msg.status === 'error') {
                    removeTypingIndicator();
                    addMessageToAIChat('ai', 'Lo siento, hubo un error al generar la respuesta. ' + (msg.statusText || ''));
                } else if (msg.status === 'incomplete') {
                    // Actualizar mensaje en streaming
                    updateAIResponse(msg.content);
                } else if (msg.status === 'complete') {
                    // Respuesta completa
                    removeTypingIndicator();
                    addMessageToAIChat('ai', msg.content);
                }
            });
        }
        
        // Agregar mensaje al chat IA
        function addMessageToAIChat(sender, message) {
            const container = document.getElementById('chat-ia-mensajes');
            if (!container) return;
            
            const messageElement = document.createElement('div');
            messageElement.className = 'flex items-start mb-4';
            
            if (sender === 'user') {
                messageElement.innerHTML = `
                    <div class="flex items-start ml-auto max-w-[80%]">
                        <div class="bg-discord-primary rounded-lg p-3 mr-3">
                            <p class="text-sm text-white">${message}</p>
                        </div>
                        <div class="w-8 h-8 bg-discord-success rounded-full flex items-center justify-center">
                            <i class="fas fa-user text-white text-xs"></i>
                        </div>
                    </div>
                `;
            } else {
                messageElement.innerHTML = `
                    <div class="w-8 h-8 bg-gradient-to-r from-discord-primary to-purple-600 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-robot text-white text-xs"></i>
                    </div>
                    <div class="flex-grow max-w-[80%]">
                        <div class="bg-discord-input/30 rounded-lg p-3">
                            <div class="text-sm markdown-content">${marked.parse(message)}</div>
                        </div>
                        <div class="flex items-center mt-2 space-x-2">
                            <button class="text-xs discord-text-secondary hover:text-discord-primary">
                                <i class="fas fa-thumbs-up mr-1"></i>Útil
                            </button>
                            <button class="text-xs discord-text-secondary hover:text-discord-primary">
                                <i class="fas fa-copy mr-1"></i>Copiar
                            </button>
                            <button class="text-xs discord-text-secondary hover:text-discord-primary">
                                <i class="fas fa-share mr-1"></i>Compartir
                            </button>
                        </div>
                    </div>
                `;
            }
            
            container.appendChild(messageElement);
            container.scrollTop = container.scrollHeight;
        }
        
        // Agregar indicador de que la IA está escribiendo
        function addTypingIndicator() {
            const container = document.getElementById('chat-ia-mensajes');
            if (!container) return;
            
            const typingElement = document.createElement('div');
            typingElement.id = 'typing-indicator';
            typingElement.className = 'flex items-start mb-4';
            typingElement.innerHTML = `
                <div class="w-8 h-8 bg-gradient-to-r from-discord-primary to-purple-600 rounded-full flex items-center justify-center mr-3">
                    <i class="fas fa-robot text-white text-xs"></i>
                </div>
                <div class="bg-discord-input/30 rounded-lg p-3">
                    <div class="flex space-x-1">
                        <div class="w-2 h-2 bg-discord-text-secondary rounded-full animate-pulse"></div>
                        <div class="w-2 h-2 bg-discord-text-secondary rounded-full animate-pulse" style="animation-delay: 0.2s;"></div>
                        <div class="w-2 h-2 bg-discord-text-secondary rounded-full animate-pulse" style="animation-delay: 0.4s;"></div>
                    </div>
                </div>
            `;
            
            container.appendChild(typingElement);
            container.scrollTop = container.scrollHeight;
        }
        
        // Remover indicador de escritura
        function removeTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) {
                indicator.remove();
            }
        }
        
        // Actualizar respuesta de IA en streaming
        function updateAIResponse(content) {
            // Si existe el indicador de escritura, reemplazarlo con el contenido
            let indicator = document.getElementById('typing-indicator');
            if (indicator) {
                // Crear nuevo elemento de mensaje
                const messageElement = document.createElement('div');
                messageElement.id = 'streaming-response';
                messageElement.className = 'flex items-start mb-4';
                messageElement.innerHTML = `
                    <div class="w-8 h-8 bg-gradient-to-r from-discord-primary to-purple-600 rounded-full flex items-center justify-center mr-3">
                        <i class="fas fa-robot text-white text-xs"></i>
                    </div>
                    <div class="flex-grow max-w-[80%]">
                        <div class="bg-discord-input/30 rounded-lg p-3">
                            <div class="text-sm markdown-content">${marked.parse(content)}</div>
                        </div>
                    </div>
                `;
                
                // Reemplazar indicador con mensaje
                indicator.replaceWith(messageElement);
            } else {
                // Actualizar mensaje existente
                const streamingResponse = document.getElementById('streaming-response');
                if (streamingResponse) {
                    const contentDiv = streamingResponse.querySelector('.markdown-content');
                    if (contentDiv) {
                        contentDiv.innerHTML = marked.parse(content);
                    }
                }
            }
            
            // Scroll hacia abajo
            const container = document.getElementById('chat-ia-mensajes');
            if (container) {
                container.scrollTop = container.scrollHeight;
            }
        }
        
        // Configurar herramientas IA
        function setupAITools() {
            document.getElementById('ia-interpretar-btn')?.addEventListener('click', () => {
                const input = document.getElementById('ia-input');
                if (input) {
                    input.value = '¿Puedes interpretar este pasaje bíblico para mí?';
                    input.focus();
                }
            });
            
            document.getElementById('ia-conectar-btn')?.addEventListener('click', () => {
                const input = document.getElementById('ia-input');
                if (input) {
                    input.value = 'Ayúdame a encontrar conexiones temáticas con otros pasajes.';
                    input.focus();
                }
            });
            
            document.getElementById('ia-resumir-btn')?.addEventListener('click', () => {
                const input = document.getElementById('ia-input');
                if (input) {
                    input.value = `Haz un resumen del capítulo ${currentBook} ${currentChapter}.`;
                    input.focus();
                }
            });
            
            document.getElementById('ia-preguntas-btn')?.addEventListener('click', () => {
                const input = document.getElementById('ia-input');
                if (input) {
                    input.value = 'Genera preguntas de estudio para este pasaje.';
                    input.focus();
                }
            });
            
            document.getElementById('ia-plan-btn')?.addEventListener('click', () => {
                const input = document.getElementById('ia-input');
                if (input) {
                    input.value = 'Crea un plan de estudio personalizado para mí.';
                    input.focus();
                }
            });
        }
        
        // Configurar sugerencias IA
        function setupAISuggestions() {
            // Nueva conversación
            document.getElementById('nueva-conversacion-btn')?.addEventListener('click', () => {
                clearAIChat();
            });
            
            // Guardar conversación
            document.getElementById('guardar-conversacion-btn')?.addEventListener('click', () => {
                saveAIConversation();
            });
        }
        
        // Limpiar chat IA
        function clearAIChat() {
            const container = document.getElementById('chat-ia-mensajes');
            if (container) {
                container.innerHTML = `
                    <div class="flex items-start">
                        <div class="w-8 h-8 bg-gradient-to-r from-discord-primary to-purple-600 rounded-full flex items-center justify-center mr-3">
                            <i class="fas fa-robot text-white text-xs"></i>
                        </div>
                        <div class="flex-grow">
                            <div class="bg-discord-input/30 rounded-lg p-3">
                                <p class="text-sm mb-2">¡Hola! Soy TeólogoIA, tu asistente para estudios bíblicos. ¿En qué puedo ayudarte hoy?</p>
                            </div>
                        </div>
                    </div>
                `;
            }
        }
        
        // Guardar conversación IA
        function saveAIConversation() {
            showNotification('Conversación guardada', 'La conversación ha sido guardada en tu historial.', 'success');
        }
        
        // Inicializar estadísticas
        function initializeStats() {
            setupStatsCharts();
        }
        
        // Configurar gráficos de estadísticas
        function setupStatsCharts() {
            // Gráfico de progreso semanal
            const ctx1 = document.getElementById('grafico-progreso-semanal');
            if (ctx1) {
                new Chart(ctx1, {
                    type: 'line',
                    data: {
                        labels: ['Lun', 'Mar', 'Mié', 'Jue', 'Vie', 'Sáb', 'Dom'],
                        datasets: [{
                            label: 'Tiempo de estudio (minutos)',
                            data: [45, 60, 30, 75, 50, 90, 65],
                            borderColor: 'rgb(88, 101, 242)',
                            backgroundColor: 'rgba(88, 101, 242, 0.1)',
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                labels: {
                                    color: 'rgba(220, 221, 222, 0.8)'
                                }
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true,
                                ticks: {
                                    color: 'rgba(220, 221, 222, 0.8)'
                                },
                                grid: {
                                    color: 'rgba(47, 49, 54, 0.6)'
                                }
                            },
                            x: {
                                ticks: {
                                    color: 'rgba(220, 221, 222, 0.8)'
                                },
                                grid: {
                                    color: 'rgba(47, 49, 54, 0.6)'
                                }
                            }
                        }
                    }
                });
            }
            
            // Gráfico de libros estudiados
            const ctx2 = document.getElementById('grafico-libros-estudiados');
            if (ctx2) {
                new Chart(ctx2, {
                    type: 'doughnut',
                    data: {
                        labels: ['Génesis', 'Éxodo', 'Mateo', 'Juan', 'Romanos'],
                        datasets: [{
                            data: [25, 20, 15, 20, 20],
                            backgroundColor: [
                                'rgb(88, 101, 242)',
                                'rgb(87, 242, 135)',
                                'rgb(254, 231, 92)',
                                'rgb(237, 66, 69)',
                                'rgb(139, 69, 19)'
                            ]
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        plugins: {
                            legend: {
                                position: 'bottom',
                                labels: {
                                    color: 'rgba(220, 221, 222, 0.8)',
                                    padding: 20
                                }
                            }
                        }
                    }
                });
            }
        }
        
        // Cargar datos de estadísticas
        function loadStatsData() {
            // Actualizar métricas en tiempo real
            updateStatsMetrics();
        }
        
        // Actualizar métricas de estadísticas
        function updateStatsMetrics() {
            // Simular actualización de datos
            console.log('Actualizando métricas de estadísticas...');
        }
        
        // Inicializar búsqueda
        function initializeSearch() {
            const searchInput = document.getElementById('busqueda-global');
            const suggestions = document.getElementById('busqueda-sugerencias');
            
            if (searchInput && suggestions) {
                searchInput.addEventListener('input', (e) => {
                    const query = e.target.value.trim();
                    if (query.length > 2) {
                        showSearchSuggestions(query);
                    } else {
                        hideSearchSuggestions();
                    }
                });
                
                // Ocultar sugerencias al hacer clic fuera
                document.addEventListener('click', (e) => {
                    if (!searchInput.contains(e.target) && !suggestions.contains(e.target)) {
                        hideSearchSuggestions();
                    }
                });
            }
        }
        
        // Mostrar sugerencias de búsqueda
        function showSearchSuggestions(query) {
            const suggestions = document.getElementById('busqueda-sugerencias');
            if (!suggestions) return;
            
            // Simular sugerencias
            const mockSuggestions = [
                { type: 'verse', text: 'Juan 3:16', description: 'Porque de tal manera amó Dios al mundo...' },
                { type: 'book', text: 'Génesis', description: '50 capítulos' },
                { type: 'topic', text: 'Amor de Dios', description: '156 referencias' },
                { type: 'person', text: 'David', description: 'Rey de Israel' }
            ];
            
            suggestions.innerHTML = '';
            
            mockSuggestions.forEach(suggestion => {
                const item = document.createElement('div');
                item.className = 'p-3 hover:bg-discord-input/20 cursor-pointer border-b border-discord-input/30 last:border-b-0';
                item.innerHTML = `
                    <div class="flex items-center">
                        <i class="fas fa-${getIconForType(suggestion.type)} mr-3 discord-text-muted"></i>
                        <div>
                            <div class="font-medium">${suggestion.text}</div>
                            <div class="text-xs discord-text-secondary">${suggestion.description}</div>
                        </div>
                    </div>
                `;
                
                item.addEventListener('click', () => {
                    selectSearchResult(suggestion);
                });
                
                suggestions.appendChild(item);
            });
            
            suggestions.classList.remove('hidden');
        }
        
        // Obtener icono para tipo de sugerencia
        function getIconForType(type) {
            switch(type) {
                case 'verse': return 'quote-right';
                case 'book': return 'book';
                case 'topic': return 'tag';
                case 'person': return 'user';
                default: return 'search';
            }
        }
        
        // Ocultar sugerencias de búsqueda
        function hideSearchSuggestions() {
            const suggestions = document.getElementById('busqueda-sugerencias');
            if (suggestions) {
                suggestions.classList.add('hidden');
            }
        }
        
        // Seleccionar resultado de búsqueda
        function selectSearchResult(result) {
            hideSearchSuggestions();
            
            // Limpiar input
            const searchInput = document.getElementById('busqueda-global');
            if (searchInput) {
                searchInput.value = '';
            }
            
            // Navegar al resultado
            navigateToResult(result);
        }
        
        // Navegar a resultado
        function navigateToResult(result) {
            switch(result.type) {
                case 'verse':
                    showSection('biblia');
                    // Navegar al versículo específico
                    break;
                case 'book':
                    showSection('biblia');
                    // Seleccionar libro
                    break;
                case 'topic':
                    showSection('filtros');
                    // Mostrar filtro por tema
                    break;
            }
            
            showNotification('Navegando', `Mostrando resultados para: ${result.text}`, 'info');
        }
        
        // Inicializar tooltips
        function initializeTooltips() {
            const tooltip = document.getElementById('tooltip');
            
            document.addEventListener('mouseover', (e) => {
                if (e.target.hasAttribute('data-tooltip')) {
                    showTooltip(e.target, e.target.getAttribute('data-tooltip'));
                }
            });
            
            document.addEventListener('mouseout', (e) => {
                if (e.target.hasAttribute('data-tooltip')) {
                    hideTooltip();
                }
            });
        }
        
        // Mostrar tooltip
        function showTooltip(element, text) {
            const tooltip = document.getElementById('tooltip');
            if (!tooltip) return;
            
            tooltip.textContent = text;
            tooltip.classList.remove('hidden');
            
            const rect = element.getBoundingClientRect();
            tooltip.style.left = rect.left + (rect.width / 2) - (tooltip.offsetWidth / 2) + 'px';
            tooltip.style.top = rect.top - tooltip.offsetHeight - 8 + 'px';
        }
        
        // Ocultar tooltip
        function hideTooltip() {
            const tooltip = document.getElementById('tooltip');
            if (tooltip) {
                tooltip.classList.add('hidden');
            }
        }
        
        // Inicializar atajos de teclado
        function initializeKeyboardShortcuts() {
            document.addEventListener('keydown', (e) => {
                // Ctrl/Cmd + K: Búsqueda
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    document.getElementById('busqueda-global')?.focus();
                }
                
                // Ctrl/Cmd + B: Ir a Biblia
                if ((e.ctrlKey || e.metaKey) && e.key === 'b') {
                    e.preventDefault();
                    showSection('biblia');
                }
                
                // Ctrl/Cmd + E: Ir a Estudio
                if ((e.ctrlKey || e.metaKey) && e.key === 'e') {
                    e.preventDefault();
                    showSection('estudio');
                }
                
                // Esc: Cerrar modal
                if (e.key === 'Escape') {
                    closeModal();
                }
                
                // Arrows para navegación de capítulos (solo en sección Biblia)
                if (document.getElementById('content-biblia').classList.contains('hidden') === false) {
                    if (e.key === 'ArrowLeft' && e.altKey) {
                        e.preventDefault();
                        if (currentChapter > 1) {
                            loadChapter(currentChapter - 1);
                        }
                    }
                    
                    if (e.key === 'ArrowRight' && e.altKey) {
                        e.preventDefault();
                        loadChapter(currentChapter + 1);
                    }
                }
            });
        }
        
        // Inicializar notificaciones
        function initializeNotifications() {
            // Configurar sistema de notificaciones
            if ('Notification' in window) {
                Notification.requestPermission();
            }
        }
        
        // Sistema de notificaciones mejorado
        function showNotification(title, message, type = 'info', duration = 5000) {
            const container = document.getElementById('notification-container');
            if (!container) return;
            
            const notification = document.createElement('div');
            notification.className = `notificacion discord-card p-4 rounded-lg shadow-lg max-w-sm w-full transform translate-x-full transition-transform duration-300`;
            
            const icons = {
                info: 'fas fa-info-circle text-blue-500',
                success: 'fas fa-check-circle text-green-500',
                warning: 'fas fa-exclamation-triangle text-yellow-500',
                error: 'fas fa-times-circle text-red-500'
            };
            
            notification.innerHTML = `
                <div class="flex items-start">
                    <div class="flex-shrink-0 mr-3">
                        <i class="${icons[type]}"></i>
                    </div>
                    <div class="flex-grow">
                        <h4 class="font-medium">${title}</h4>
                        <p class="text-sm discord-text-secondary mt-1">${message}</p>
                    </div>
                    <button class="cerrar-notificacion-btn flex-shrink-0 ml-2 discord-text-muted hover:discord-text-primary">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="progress-bar mt-3">
                    <div class="progress-fill bg-${type === 'error' ? 'red' : type === 'warning' ? 'yellow' : type === 'success' ? 'green' : 'blue'}-500 h-1 w-full"></div>
                </div>
            `;
            
            container.appendChild(notification);
            
            // Animar entrada
            setTimeout(() => {
                notification.classList.remove('translate-x-full');
                notification.classList.add('mostrar');
            }, 100);
            
            // Configurar cierre
            const closeBtn = notification.querySelector('.cerrar-notificacion-btn');
            closeBtn.addEventListener('click', () => {
                removeNotification(notification);
            });
            
            // Auto-cerrar
            const progressBar = notification.querySelector('.progress-fill');
            if (progressBar) {
                progressBar.style.transition = `width ${duration}ms linear`;
                progressBar.style.width = '0%';
            }
            
            setTimeout(() => {
                removeNotification(notification);
            }, duration);
        }
        
        // Remover notificación
        function removeNotification(notification) {
            notification.style.transform = 'translateX(100%)';
            setTimeout(() => {
                if (notification.parentNode) {
                    notification.remove();
                }
            }, 300);
        }
        
        // Sistema de modales mejorado
        function showModal(title, content, footer = '') {
            const overlay = document.getElementById('modal-overlay');
            const modalTitle = document.getElementById('modal-title');
            const modalContent = document.getElementById('modal-content');
            const modalFooter = document.getElementById('modal-footer');
            
            if (overlay && modalTitle && modalContent) {
                modalTitle.textContent = title;
                modalContent.innerHTML = content;
                
                if (footer) {
                    modalFooter.innerHTML = footer;
                    modalFooter.classList.remove('hidden');
                } else {
                    modalFooter.classList.add('hidden');
                }
                
                overlay.classList.remove('hidden');
                document.body.style.overflow = 'hidden';
            }
        }
        
        // Cerrar modal
        function closeModal() {
            const overlay = document.getElementById('modal-overlay');
            if (overlay) {
                overlay.classList.add('hidden');
                document.body.style.overflow = '';
            }
        }
        
        // Configurar cierre de modal
        document.getElementById('modal-close-btn')?.addEventListener('click', closeModal);
        document.getElementById('modal-overlay')?.addEventListener('click', (e) => {
            if (e.target.id === 'modal-overlay') {
                closeModal();
            }
        });
        
        // Inicializar temporizador de sesión
        function startStudySession() {
            setInterval(() => {
                studySession.duration = Date.now() - studySession.startTime;
                updateSessionTimer();
                updateSessionProgress();
            }, 1000);
        }
        
        // Actualizar temporizador de sesión
        function updateSessionTimer() {
            const timer = document.getElementById('tiempo-sesion');
            if (timer) {
                const minutes = Math.floor(studySession.duration / 60000);
                const seconds = Math.floor((studySession.duration % 60000) / 1000);
                timer.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
            }
        }
        
        // Actualizar progreso de sesión
        function updateSessionProgress() {
            const progress = document.getElementById('progreso-sesion');
            if (progress) {
                // Meta de 30 minutos por sesión
                const targetMinutes = 30;
                const currentMinutes = studySession.duration / 60000;
                const percentage = Math.min((currentMinutes / targetMinutes) * 100, 100);
                progress.style.width = percentage + '%';
            }
        }
        
        // Funciones adicionales que serían implementadas...
        function initializeFilters() {
            console.log('Inicializando filtros avanzados...');
        }
        
        function initializeSocial() {
            console.log('Inicializando funcionalidades sociales...');
            setupSocialChat();
        }
        
        function setupSocialChat() {
            const enviarBtn = document.getElementById('enviar-mensaje-btn');
            const messageInput = document.getElementById('mensaje-input');
            
            if (enviarBtn && messageInput) {
                enviarBtn.addEventListener('click', () => {
                    sendSocialMessage();
                });
                
                messageInput.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' && !e.shiftKey) {
                        e.preventDefault();
                        sendSocialMessage();
                    }
                });
            }
        }
        
        function sendSocialMessage() {
            const input = document.getElementById('mensaje-input');
            const container = document.getElementById('chat-mensajes');
            
            if (!input || !container || !input.value.trim()) return;
            
            const message = input.value.trim();
            input.value = '';
            
            // Agregar mensaje al chat
            const messageElement = document.createElement('div');
            messageElement.className = 'mensaje-chat propio';
            messageElement.innerHTML = `
                <div class="flex items-start">
                    <div class="flex-grow">
                        <div class="flex items-center mb-1">
                            <span class="font-semibold">Tú</span>
                            <span class="ml-2 text-xs discord-text-secondary">ahora</span>
                        </div>
                        <p class="text-sm">${message}</p>
                    </div>
                    <div class="w-10 h-10 bg-discord-primary rounded-full flex items-center justify-center ml-3">
                        <span class="text-sm">TU</span>
                    </div>
                </div>
            `;
            
            container.appendChild(messageElement);
            container.scrollTop = container.scrollHeight;
        }
        
        function loadSocialContent() {
            console.log('Cargando contenido social...');
        }
        
        function loadAIHistory() {
            console.log('Cargando historial de IA...');
        }
        
        function showUserMenu() {
            showModal('Perfil de Usuario', `
                <div class="text-center mb-6">
                    <div class="w-20 h-20 bg-discord-primary rounded-full flex items-center justify-center mx-auto mb-4">
                        <i class="fas fa-user text-white text-2xl"></i>
                    </div>
                    <h3 class="text-xl font-semibold">${currentUser.name}</h3>
                    <p class="discord-text-secondary">Nivel ${currentUser.level} - ${currentUser.xp} XP</p>
                </div>
                
                <div class="grid grid-cols-2 gap-4 mb-6">
                    <div class="text-center p-4 bg-discord-input/20 rounded">
                        <div class="text-2xl font-bold text-discord-primary">${currentUser.booksCompleted}</div>
                        <div class="text-sm discord-text-secondary">Libros completados</div>
                    </div>
                    <div class="text-center p-4 bg-discord-input/20 rounded">
                        <div class="text-2xl font-bold text-discord-success">${currentUser.notesCount}</div>
                        <div class="text-sm discord-text-secondary">Notas tomadas</div>
                    </div>
                </div>
                
                <div class="space-y-3">
                    <button class="w-full discord-button-secondary px-4 py-2 rounded text-left">
                        <i class="fas fa-cog mr-2"></i>Configuración de perfil
                    </button>
                    <button class="w-full discord-button-secondary px-4 py-2 rounded text-left">
                        <i class="fas fa-history mr-2"></i>Historial de estudio
                    </button>
                    <button class="w-full discord-button-secondary px-4 py-2 rounded text-left">
                        <i class="fas fa-trophy mr-2"></i>Logros
                    </button>
                    <button class="w-full discord-button-danger px-4 py-2 rounded text-left">
                        <i class="fas fa-sign-out-alt mr-2"></i>Cerrar sesión
                    </button>
                </div>
            `, `
                <button onclick="closeModal()" class="discord-button-secondary px-4 py-2 rounded">Cerrar</button>
            `);
        }
        
        function showSettings() {
            showModal('Configuración', `
                <div class="space-y-6">
                    <div>
                        <h4 class="font-medium mb-3">Apariencia</h4>
                        <div class="space-y-3">
                            <div>
                                <label class="text-sm discord-text-secondary">Tema</label>
                                <select class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                    <option value="auto">Automático</option>
                                    <option value="dark">Oscuro</option>
                                    <option value="light">Claro</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-sm discord-text-secondary">Tamaño de texto</label>
                                <select class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                    <option value="small">Pequeño</option>
                                    <option value="normal">Normal</option>
                                    <option value="large">Grande</option>
                                    <option value="extra-large">Extra grande</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-medium mb-3">Estudio</h4>
                        <div class="space-y-3">
                            <div>
                                <label class="text-sm discord-text-secondary">Versión predeterminada</label>
                                <select class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                    <option value="rvr1960">Reina Valera 1960</option>
                                    <option value="nvi">Nueva Versión Internacional</option>
                                    <option value="dhh">Dios Habla Hoy</option>
                                </select>
                            </div>
                            <div>
                                <label class="text-sm discord-text-secondary">Plan de lectura</label>
                                <select class="w-full discord-input text-sm rounded px-2 py-1 mt-1">
                                    <option value="none">Ninguno</option>
                                    <option value="chronological">Cronológico</option>
                                    <option value="thematic">Temático</option>
                                    <option value="complete">Biblia completa</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    
                    <div>
                        <h4 class="font-medium mb-3">Notificaciones</h4>
                        <div class="space-y-2">
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-2" checked>
                                <span class="text-sm">Recordatorios de lectura</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-2" checked>
                                <span class="text-sm">Eventos de la comunidad</span>
                            </label>
                            <label class="flex items-center">
                                <input type="checkbox" class="mr-2">
                                <span class="text-sm">Actualizaciones de la aplicación</span>
                            </label>
                        </div>
                    </div>
                </div>
            `, `
                <button onclick="closeModal()" class="discord-button-secondary px-4 py-2 rounded mr-2">Cancelar</button>
                <button onclick="saveSettings(); closeModal();" class="discord-button-primary px-4 py-2 rounded">Guardar</button>
            `);
        }
        
        function showNotificationsPanel() {
            showModal('Notificaciones', `
                <div class="space-y-4">
                    <div class="flex justify-between items-center">
                        <h4 class="font-medium">Notificaciones recientes</h4>
                        <button class="text-sm discord-button-secondary px-3 py-1 rounded">Marcar como leídas</button>
                    </div>
                    
                    <div class="space-y-3">
                        <div class="p-3 bg-discord-input/20 rounded-lg border-l-4 border-discord-primary">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h5 class="font-medium">Nuevo evento de estudio</h5>
                                    <p class="text-sm discord-text-secondary mt-1">Estudio de profecías mesiánicas - Viernes 7:00 PM</p>
                                </div>
                                <span class="text-xs discord-text-secondary">hace 2h</span>
                            </div>
                        </div>
                        
                        <div class="p-3 bg-discord-input/20 rounded-lg border-l-4 border-discord-success">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h5 class="font-medium">Meta completada</h5>
                                    <p class="text-sm discord-text-secondary mt-1">¡Has completado tu meta de lectura semanal!</p>
                                </div>
                                <span class="text-xs discord-text-secondary">hace 5h</span>
                            </div>
                        </div>
                        
                        <div class="p-3 bg-discord-input/20 rounded-lg border-l-4 border-discord-warning">
                            <div class="flex justify-between items-start">
                                <div>
                                    <h5 class="font-medium">Recordatorio</h5>
                                    <p class="text-sm discord-text-secondary mt-1">No olvides tu tiempo de estudio de hoy</p>
                                </div>
                                <span class="text-xs discord-text-secondary">hace 1d</span>
                            </div>
                        </div>
                    </div>
                    
                    <div class="text-center pt-4">
                        <button class="discord-button-secondary px-4 py-2 rounded">Ver todas las notificaciones</button>
                    </div>
                </div>
            `, `
                <button onclick="closeModal()" class="discord-button-secondary px-4 py-2 rounded">Cerrar</button>
            `);
        }
        
        function saveSettings() {
            showNotification('Configuración guardada', 'Tus preferencias han sido actualizadas correctamente.', 'success');
        }
        
        function saveNote() {
            currentUser.notesCount++;
            showNotification('Nota guardada', 'Tu nota ha sido guardada correctamente.', 'success');
        }
        
        function goToReference(reference) {
            showNotification('Navegando', `Yendo a ${reference}...`, 'info');
        }
        
        function playAudio() {
            showNotification('Audio', 'Función de audio en desarrollo.', 'info');
        }
        
        function shareChapter() {
            if (navigator.share) {
                navigator.share({
                    title: `${currentBook} ${currentChapter}`,
                    text: `Estoy estudiando ${currentBook} ${currentChapter} en Formación Bíblica Avanzada`,
                    url: window.location.href
                });
            } else {
                navigator.clipboard.writeText(window.location.href);
                showNotification('Enlace copiado', 'El enlace ha sido copiado al portapapeles.', 'success');
            }
        }
        
        // Registrar service worker para PWA
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('SW registrado: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW falló: ', registrationError);
                    });
            });
        }
        
        // Analytics y telemetría
        function trackUserAction(action, data = {}) {
            console.log('Acción del usuario:', action, data);
            // Aquí se enviarían los datos a un servicio de analytics
        }
        
        // Optimizaciones de rendimiento
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        function throttle(func, limit) {
            let inThrottle;
            return function() {
                const args = arguments;
                const context = this;
                if (!inThrottle) {
                    func.apply(context, args);
                    inThrottle = true;
                    setTimeout(() => inThrottle = false, limit);
                }
            }
        }
        
        // Manejo de errores global
        window.addEventListener('error', (event) => {
            console.error('Error global:', event.error);
            showNotification('Error', 'Se ha producido un error inesperado.', 'error');
        });
        
        window.addEventListener('unhandledrejection', (event) => {
            console.error('Promesa rechazada:', event.reason);
            showNotification('Error de conexión', 'Problema de conectividad detectado.', 'warning');
        });
        
        // Backup y sincronización de datos
        function backupUserData() {
            const userData = {
                currentUser,
                currentBook,
                currentChapter,
                settings: {
                    theme: currentTheme
                },
                timestamp: Date.now()
            };
            
            localStorage.setItem('formacion_biblica_backup', JSON.stringify(userData));
        }
        
        function restoreUserData() {
            const backup = localStorage.getItem('formacion_biblica_backup');
            if (backup) {
                try {
                    const data = JSON.parse(backup);
                    currentUser = { ...currentUser, ...data.currentUser };
                    currentBook = data.currentBook || currentBook;
                    currentChapter = data.currentChapter || currentChapter;
                    if (data.settings?.theme) {
                        setTheme(data.settings.theme);
                    }
                } catch (error) {
                    console.error('Error al restaurar datos:', error);
                }
            }
        }
        
        // Guardar datos automáticamente cada 30 segundos
        setInterval(backupUserData, 30000);
        
        // Restaurar datos al cargar
        document.addEventListener('DOMContentLoaded', restoreUserData);
        
        console.log('🎉 Formación Bíblica Avanzada v2.0 - Sistema completo cargado');
    </script>
</body>
</html>
